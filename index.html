<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>MACRO TERMINAL v4.0</title>
<script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet"/>
<style>
*{box-sizing:border-box;margin:0;padding:0;}
html,body,#root{min-height:100vh;background:#060810;}
::-webkit-scrollbar{width:4px;height:4px;}
::-webkit-scrollbar-track{background:#060810;}
::-webkit-scrollbar-thumb{background:#1c2333;border-radius:2px;}
input[type=range]{-webkit-appearance:none;background:transparent;cursor:pointer;width:100%;}
input[type=range]::-webkit-slider-runnable-track{background:#1c2333;border-radius:4px;height:4px;}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:14px;height:14px;border-radius:50%;background:#00d4ff;margin-top:-5px;box-shadow:0 0 8px #00d4ff88;}
input[type=range].gold::-webkit-slider-thumb{background:#f0b429;box-shadow:0 0 8px #f0b42988;}
.btn{padding:4px 12px;border-radius:4px;font-size:10px;font-family:'JetBrains Mono',monospace;cursor:pointer;transition:all .18s;border:1px solid #1c2333;background:transparent;color:#5a6a7a;}
.btn:hover{opacity:.85;}
.btn.active{border-color:#00d4ff;background:#00d4ff18;color:#00d4ff;}
.btn.gold-active{border-color:#f0b429;background:#f0b42918;color:#f0b429;}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const {useState,useEffect,useRef,useMemo,useCallback}=React;

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONSTANTS & DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const C={bg:"#060810",panel:"#0d1117",border:"#1c2333",
  accent:"#00d4ff",gold:"#f0b429",green:"#00e676",red:"#ff1744",
  purple:"#bb86fc",text:"#e0e6f0",muted:"#5a6a7a",dim:"#3a4a5a"};

const TIER_COLORS={xl:"#ff4060",lg:"#ff9800",md:"#f0b429",sm:"#00e676"};
const TIER_CFG={
  xl:{strokeW:4.5,maxR:8,  count:13,labelSz:12,badge:"XL"},
  lg:{strokeW:3.0,maxR:5.5,count:9, labelSz:11,badge:"LG"},
  md:{strokeW:1.8,maxR:3.5,count:6, labelSz:10,badge:"MD"},
  sm:{strokeW:1.0,maxR:2.2,count:4, labelSz:9, badge:"SM"},
};

/* â”€â”€ ë¡¤ë§ 24ê°œì›” ìƒì„± (ì˜¤ëŠ˜ ê¸°ì¤€) â”€â”€ */
function buildMonths(n=24){
  const now=new Date(), arr=[];
  for(let i=n-1;i>=0;i--){
    const d=new Date(now.getFullYear(),now.getMonth()-i,1);
    arr.push({year:d.getFullYear(),mo:d.getMonth(),
      label:`${d.getFullYear()}.${String(d.getMonth()+1).padStart(2,'0')}`,
      isCurrent:i===0});
  }
  return arr;
}
const MONTHS=buildMonths(24);

/* â”€â”€ ìê¸ˆ íë¦„ ë°ì´í„° (ê¸°ì €+ê³„ì ˆì„±+íŠ¸ë Œë“œ+ë…¸ì´ì¦ˆ, ì‹œë“œ ê³ ì •) â”€â”€ */
function seededRand(seed){let s=seed%2147483647;if(s<=0)s+=2147483646;return()=>{s=s*16807%2147483647;return(s-1)/2147483646;};}
function genFlow(base,phase,trend,n=24){
  const r=seededRand(Math.round(base*100+phase*10));
  return Array.from({length:n},(_,i)=>{
    const seasonal=Math.sin((i/12)*2*Math.PI+phase)*base*0.22;
    const trendV=(i/n)*trend;
    const noise=(r()-0.5)*base*0.10;
    return Math.round(Math.max(15,base+seasonal+trendV+noise));
  });
}

const EDGES_DEF=[
  {from:"bonds", to:"us_eq",  tier:"xl",base:420,phase:0.0, trend:+60, label:"ê¸ˆë¦¬ì¸í•˜ ê¸°ëŒ€"},
  {from:"usd",   to:"crypto", tier:"xl",base:310,phase:1.0, trend:+80, label:"ë¦¬ìŠ¤í¬ì˜¨"},
  {from:"asia",  to:"us_eq",  tier:"lg",base:275,phase:0.3, trend:+30, label:"ë‹¬ëŸ¬ ê°•ì„¸"},
  {from:"usd",   to:"us_eq",  tier:"lg",base:255,phase:0.8, trend:+50, label:"AI ë¶"},
  {from:"eu_eq", to:"us_eq",  tier:"lg",base:195,phase:0.5, trend:+20, label:"ì„±ì¥ ê²©ì°¨"},
  {from:"asia",  to:"gold",   tier:"lg",base:180,phase:1.5, trend:+15, label:"ì§€ì •í•™ í—¤ì§€"},
  {from:"eu_eq", to:"bonds",  tier:"md",base:145,phase:0.2, trend:+10, label:"ECB ì™„í™”"},
  {from:"bonds", to:"usd",    tier:"md",base:130,phase:2.0, trend:-10, label:"ì•ˆì „ìì‚° ì„ í˜¸"},
  {from:"crypto",to:"us_eq",  tier:"md",base:120,phase:1.2, trend:+40, label:"ê¸°ê´€ ìˆœí™˜"},
  {from:"kr_eq", to:"usd",    tier:"sm",base: 85,phase:0.7, trend:-20, label:"ì™¸êµ­ì¸ ìˆœë§¤ë„"},
  {from:"usd",   to:"gold",   tier:"sm",base: 75,phase:1.8, trend:+10, label:"ì¸í”Œë ˆ í—¤ì§€"},
  {from:"comm",  to:"asia",   tier:"sm",base: 62,phase:0.4, trend: +5, label:"ì›ìì¬ ìˆ˜ìš”"},
];
const EDGES_DATA=EDGES_DEF.map(e=>({...e,amounts:genFlow(e.base,e.phase,e.trend,24)}));

/* â”€â”€ ì§€ë„ ìœ„ ë…¸ë“œ ìœ„ì¹˜ (ì§€ë¦¬ì ìœ¼ë¡œ ëŒ€ëµ ë°˜ì˜) â”€â”€ */
const NODES=[
  {id:"us_eq",  label:"ë¯¸êµ­ ì£¼ì‹",    en:"US Equities",   x:0.18,y:0.32,r:60,color:"#00d4ff"},
  {id:"eu_eq",  label:"ìœ ëŸ½ ì£¼ì‹",    en:"EU Equities",   x:0.49,y:0.22,r:46,color:"#7c6af5"},
  {id:"asia",   label:"ì•„ì‹œì•„ ì‹ í¥êµ­",en:"EM Asia",       x:0.77,y:0.38,r:50,color:"#f0b429"},
  {id:"kr_eq",  label:"í•œêµ­ ì£¼ì‹",    en:"KR Equities",   x:0.82,y:0.32,r:36,color:"#ff9800"},
  {id:"bonds",  label:"ì±„ê¶Œ",         en:"Bonds",         x:0.20,y:0.18,r:52,color:"#4caf50"},
  {id:"gold",   label:"ê¸ˆ",           en:"Gold",          x:0.50,y:0.55,r:40,color:"#ffd700"},
  {id:"crypto", label:"ì•”í˜¸í™”í",     en:"Crypto",        x:0.30,y:0.70,r:48,color:"#ff6b6b"},
  {id:"usd",    label:"ë‹¬ëŸ¬ í˜„ê¸ˆ",    en:"Cash/USD",      x:0.12,y:0.55,r:42,color:"#00e676"},
  {id:"comm",   label:"ì›ìì¬",       en:"Commodities",   x:0.62,y:0.68,r:34,color:"#ff7043"},
];

/* â”€â”€ ìì‚° ìƒê´€ê´€ê³„ ë§¤íŠ¸ë¦­ìŠ¤ â”€â”€ */
const CORR_ASSETS=["USD","Gold","Silver","Oil","BTC","ETH","S&P500","KOSPI","US Bond","ë¶€ë™ì‚°","ì›ìì¬"];
const CORR_MATRIX=[
//  USD   Gold  Silv  Oil   BTC   ETH   SP5   KPSI  Bond  RE    Comm
  [ 1.00,-0.60,-0.55,-0.20, 0.10, 0.08,-0.30,-0.40, 0.30,-0.40,-0.25], // USD
  [-0.60, 1.00, 0.85, 0.30, 0.35, 0.28, 0.10, 0.15, 0.20, 0.10, 0.40], // Gold
  [-0.55, 0.85, 1.00, 0.25, 0.38, 0.30, 0.12, 0.18, 0.18, 0.08, 0.38], // Silver
  [-0.20, 0.30, 0.25, 1.00, 0.15, 0.12, 0.40, 0.35,-0.10, 0.20, 0.75], // Oil
  [ 0.10, 0.35, 0.38, 0.15, 1.00, 0.90, 0.55, 0.45,-0.15, 0.05, 0.12], // BTC
  [ 0.08, 0.28, 0.30, 0.12, 0.90, 1.00, 0.50, 0.40,-0.10, 0.02, 0.10], // ETH
  [-0.30, 0.10, 0.12, 0.40, 0.55, 0.50, 1.00, 0.70,-0.40, 0.50, 0.42], // S&P500
  [-0.40, 0.15, 0.18, 0.35, 0.45, 0.40, 0.70, 1.00,-0.30, 0.35, 0.38], // KOSPI
  [ 0.30, 0.20, 0.18,-0.10,-0.15,-0.10,-0.40,-0.30, 1.00,-0.50,-0.12], // Bond
  [-0.40, 0.10, 0.08, 0.20, 0.05, 0.02, 0.50, 0.35,-0.50, 1.00, 0.22], // ë¶€ë™ì‚°
  [-0.25, 0.40, 0.38, 0.75, 0.12, 0.10, 0.42, 0.38,-0.12, 0.22, 1.00], // ì›ìì¬
];

/* â”€â”€ ì•„ë¹„íŠ¸ë¼ì§€ ê¸°íšŒ ë°ì´í„° â”€â”€ */
const ARB_DATA=[
  {name:"ê¹€ì¹˜ í”„ë¦¬ë¯¸ì—„",       en:"BTC Kimchi Premium",   value:1.8, threshold:2.0, unit:"%",   direction:"up",   desc:"í•œêµ­ BTCê°€ê²© / ê¸€ë¡œë²Œ ëŒ€ë¹„ í”„ë¦¬ë¯¸ì—„",color:"#ff9800",type:"crypto"},
  {name:"ê¸ˆ ì„ ë¬¼ ë² ì´ì‹œìŠ¤",    en:"Gold Futures Basis",   value:12.4,threshold:20,  unit:"$/oz",direction:"up",   desc:"COMEX ì„ ë¬¼ vs í˜„ë¬¼ ìŠ¤í”„ë ˆë“œ",        color:"#ffd700",type:"commodity"},
  {name:"ë¯¸-í•œ ê¸ˆë¦¬ì°¨",        en:"US-KR Rate Spread",    value:1.50,threshold:1.0, unit:"%",   direction:"up",   desc:"US 10Y(4.52%) - KR 10Y(3.02%)",    color:"#00d4ff",type:"rate"},
  {name:"ë¯¸-ì¼ ê¸ˆë¦¬ì°¨",        en:"US-JP Rate Spread",    value:4.02,threshold:3.0, unit:"%",   direction:"up",   desc:"US 10Y(4.52%) - JP 10Y(0.50%)",    color:"#7c6af5",type:"rate"},
  {name:"ë¯¸-ìœ  ê¸ˆë¦¬ì°¨",        en:"US-EU Rate Spread",    value:1.87,threshold:1.5, unit:"%",   direction:"up",   desc:"US 10Y(4.52%) - EU 10Y(2.65%)",    color:"#4caf50",type:"rate"},
  {name:"ETH/BTC ë¹„ìœ¨",        en:"ETH/BTC Ratio",        value:0.026,threshold:0.06,unit:"",  direction:"down", desc:"ì—­ì‚¬ì  ì €ì  ê·¼ì ‘ â†’ ETH ìƒëŒ€ì  ì €í‰ê°€",color:"#ff6b6b",type:"crypto"},
  {name:"ê¸ˆ/ì€ ë¹„ìœ¨",          en:"Gold/Silver Ratio",    value:90.8,threshold:80,  unit:"x",   direction:"up",   desc:"ë¹„ìœ¨ ë†’ì„ìˆ˜ë¡ ì€ ìƒëŒ€ ì €í‰ê°€",       color:"#c0c0c0",type:"commodity"},
  {name:"VIX ìŠ¤í”„ë ˆë“œ",        en:"VIX Term Spread",      value:3.2, threshold:5.0, unit:"pt",  direction:"down", desc:"VIX3M - VIX (ìŒâ†’ì»¨íƒ±ê³  ì •ìƒí™”)",    color:"#bb86fc",type:"volatility"},
  {name:"KOSPI ë°¸ë¥˜ì—ì´ì…˜",    en:"KOSPI PBR Discount",   value:0.85,threshold:1.0, unit:"x",   direction:"down", desc:"ê¸€ë¡œë²Œ ëŒ€ë¹„ KOSPI PBR í• ì¸ (ì½”ë¦¬ì•„ ë””ìŠ¤ì¹´ìš´íŠ¸)",color:"#ff9800",type:"equity"},
  {name:"ì›ë‹¬ëŸ¬ ìºë¦¬",         en:"KRW Carry Return",     value:2.75,threshold:2.0, unit:"%",   direction:"up",   desc:"ê¸ˆë¦¬ì°¨ ê¸°ë°˜ ìºë¦¬ ìˆ˜ìµ (ì—°ìœ¨)",       color:"#00e676",type:"fx"},
];

/* â”€â”€ ì„¸ê³„ ì§€ë„ SVG ê²½ë¡œ (ë‹¨ìˆœí™” Mercator, viewBox 1000Ã—500) â”€â”€ */
const WORLD_PATHS=[
  // ë¶ë¯¸
  {d:"M 65,72 L 90,58 L 115,55 L 145,60 L 175,68 L 190,75 L 210,80 L 230,90 L 250,100 L 255,115 L 248,130 L 238,145 L 222,165 L 205,185 L 195,205 L 185,215 L 170,222 L 155,218 L 142,205 L 128,195 L 112,178 L 98,160 L 82,140 L 70,118 L 58,98 Z",color:"#1a2a40"},
  // ì¤‘ë¯¸/ì¹´ë¦¬ë¸Œ
  {d:"M 185,215 L 200,218 L 215,225 L 218,235 L 208,240 L 195,230 L 185,222 Z",color:"#1a2a40"},
  // ë‚¨ë¯¸
  {d:"M 190,245 L 220,240 L 248,248 L 265,265 L 272,295 L 270,330 L 258,368 L 240,400 L 220,418 L 200,415 L 182,400 L 170,368 L 162,330 L 160,292 L 165,262 L 178,248 Z",color:"#1a2a40"},
  // ê·¸ë¦°ë€ë“œ
  {d:"M 235,30 L 268,25 L 290,35 L 295,55 L 278,65 L 252,68 L 232,55 Z",color:"#1a2a3a"},
  // ìœ ëŸ½ ì„œë¶€
  {d:"M 430,58 L 460,52 L 490,55 L 518,62 L 535,72 L 540,88 L 528,102 L 510,112 L 490,118 L 468,115 L 448,105 L 435,90 L 428,74 Z",color:"#1a2a40"},
  // ìŠ¤ì¹¸ë””ë‚˜ë¹„ì•„
  {d:"M 468,38 L 490,32 L 510,38 L 515,52 L 495,58 L 472,55 Z",color:"#1a2a3a"},
  // ì•„í”„ë¦¬ì¹´
  {d:"M 452,148 L 490,142 L 528,145 L 558,155 L 578,178 L 585,212 L 582,255 L 568,308 L 548,358 L 522,398 L 498,412 L 472,405 L 450,375 L 435,330 L 428,278 L 425,228 L 430,185 L 438,162 Z",color:"#1a2a40"},
  // ì•„ë¼ë¹„ì•„
  {d:"M 558,148 L 592,145 L 612,158 L 615,178 L 598,195 L 572,198 L 555,185 L 548,165 Z",color:"#1a2a3a"},
  // ì•„ì‹œì•„ ì¤‘ì•™/ë¶ë¶€ (ëŸ¬ì‹œì•„ í¬í•¨)
  {d:"M 538,30 L 620,22 L 720,18 L 820,22 L 880,35 L 908,55 L 900,78 L 870,92 L 830,100 L 790,105 L 750,108 L 710,105 L 670,100 L 630,95 L 590,88 L 555,78 L 535,62 Z",color:"#1a2a40"},
  // ì•„ì‹œì•„ ë‚¨ë¶€/ë™ë‚¨ì•„
  {d:"M 612,108 L 660,112 L 700,118 L 740,125 L 768,138 L 778,158 L 762,175 L 735,185 L 700,188 L 665,182 L 635,170 L 614,155 L 608,135 Z",color:"#1a2a40"},
  // ì¸ë„
  {d:"M 638,158 L 668,155 L 692,162 L 700,185 L 695,215 L 678,238 L 658,242 L 638,232 L 624,208 L 620,185 L 628,168 Z",color:"#1a2a3a"},
  // ë™ë‚¨ì•„
  {d:"M 748,168 L 778,162 L 800,172 L 808,192 L 798,208 L 772,212 L 750,202 L 740,185 Z",color:"#1a2a3a"},
  // ì¤‘êµ­/í•œë°˜ë„/ì¼ë³¸ ì˜ì—­
  {d:"M 762,88 L 840,85 L 878,95 L 888,115 L 872,132 L 842,138 L 808,135 L 778,125 L 758,110 Z",color:"#1a2a3a"},
  // ì¼ë³¸
  {d:"M 878,88 L 895,85 L 905,98 L 898,112 L 882,115 L 870,102 Z",color:"#182238"},
  // í˜¸ì£¼
  {d:"M 755,298 L 820,290 L 862,298 L 882,322 L 880,358 L 858,385 L 825,398 L 788,392 L 760,370 L 745,338 L 742,312 Z",color:"#1a2a40"},
  // ë‰´ì§ˆëœë“œ
  {d:"M 908,355 L 920,348 L 928,362 L 920,375 L 908,368 Z",color:"#182238"},
];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UTILS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function seededR(seed){let s=seed%2147483647;if(s<=0)s+=2147483646;return()=>{s=s*16807%2147483647;return(s-1)/2147483646;};}

function corrColor(v){
  if(v>0.7)return"#00e676";if(v>0.4)return"#4caf50";if(v>0.1)return"#8bc34a";
  if(v>-0.1)return"#5a6a7a";if(v>-0.4)return"#ff7043";if(v>-0.7)return"#f44336";
  return"#ff1744";
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SUB-COMPONENTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* TradingView */
function TV({type,opts,height}){
  const ref=useRef(null);
  const uid=useRef("tv_"+Math.random().toString(36).slice(2));
  useEffect(()=>{
    if(!ref.current)return;
    ref.current.innerHTML="";
    const w=document.createElement("div");w.id=uid.current;ref.current.appendChild(w);
    const s=document.createElement("script");
    s.src=`https://s3.tradingview.com/external-embedding/embed-widget-${type}.js`;
    s.async=true;
    s.innerHTML=JSON.stringify({...opts,container_id:uid.current,width:"100%",height,colorTheme:"dark",locale:"kr",isTransparent:true});
    w.appendChild(s);
    return()=>{if(ref.current)ref.current.innerHTML="";};
  },[]);
  return <div ref={ref} style={{width:"100%",height,overflow:"hidden"}}/>;
}

/* Sparkline */
function Spark({data,width=80,height=26}){
  if(!data||data.length<2)return null;
  const mn=Math.min(...data),mx=Math.max(...data),rng=mx-mn||1;
  const pts=data.map((v,i)=>`${(i/(data.length-1))*width},${height-((v-mn)/rng)*(height-4)-2}`).join(" ");
  const up=data[data.length-1]>=data[0];
  const lc=up?C.green:C.red;
  return(
    <svg width={width} height={height} style={{display:"block"}}>
      <polyline points={pts} fill="none" stroke={lc} strokeWidth="1.5" strokeLinejoin="round" strokeLinecap="round"/>
      <circle cx={(data.length-1)/(data.length-1)*width} cy={height-((data[data.length-1]-mn)/rng)*(height-4)-2} r="2.5" fill={lc}/>
    </svg>
  );
}

/* â”€â”€ íŒŒí‹°í´ â”€â”€ */
function Particle({from,to,speed,color,maxR,opacity}){
  const prog=useRef(Math.random());
  const [p,setP]=useState(prog.current);
  useEffect(()=>{
    let raf,last=performance.now();
    const tick=now=>{prog.current=(prog.current+(now-last)/1000*speed)%1;last=now;setP(prog.current);raf=requestAnimationFrame(tick);};
    raf=requestAnimationFrame(tick);return()=>cancelAnimationFrame(raf);
  },[speed]);
  const x=from.x+(to.x-from.x)*p,y=from.y+(to.y-from.y)*p;
  const r=(maxR||4)*(0.4+(1-Math.abs(p-0.5)*2)*0.6);
  return <circle cx={`${x*100}%`} cy={`${y*100}%`} r={r} fill={color} opacity={(opacity||0.65)*(0.4+p*0.6)}/>;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CAPITAL FLOW HERO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function CapitalFlowHero(){
  const [moIdx,setMoIdx]=useState(MONTHS.length-1); // í˜„ì¬ ì›”
  const [playing,setPlaying]=useState(false);
  const [playSpeed,setPlaySpeed]=useState(1.0);
  const [flowTab,setFlowTab]=useState("map");
  const [period,setPeriod]=useState("1M"); // ê¸°ê°„ í•„í„°
  const [hoveredEdge,setHoveredEdge]=useState(null);
  const [tick,setTick]=useState(0);
  const playRef=useRef(null);

  // ìë™ ì¬ìƒ
  useEffect(()=>{
    if(playing){playRef.current=setInterval(()=>setMoIdx(m=>(m+1)%MONTHS.length),Math.round(1000/playSpeed));}
    return()=>clearInterval(playRef.current);
  },[playing,playSpeed]);

  useEffect(()=>{const iv=setInterval(()=>setTick(t=>t+1),60);return()=>clearInterval(iv);},[]);

  // ê¸°ê°„ ë°°ìˆ˜
  const periodMult={
    "1D":1/30,"1W":1/4,"2W":1/2,"1M":1,"3M":3,"6M":6,"1Y":12,"2Y":24
  };
  const mult=periodMult[period]||1;

  // í˜„ì¬ ì„ íƒ ì›” ì—£ì§€
  const edges=useMemo(()=>EDGES_DATA.map(e=>({
    ...e,
    amount:Math.round(e.amounts[moIdx]*mult),
    w:e.amounts[moIdx]/480,
  })),[moIdx,mult]);

  const maxAmt=useMemo(()=>Math.max(...edges.map(e=>e.amount)),[ edges]);
  const totalFlow=useMemo(()=>edges.reduce((s,e)=>s+e.amount,0),[edges]);
  const curMo=MONTHS[moIdx];

  // íŒŒí‹°í´ ì¬ìƒì„±
  const particles=useRef([]);
  useEffect(()=>{
    particles.current=edges.flatMap(e=>{
      const cfg=TIER_CFG[e.tier];
      const cnt=Math.max(2,Math.round(cfg.count*(0.5+e.w)));
      return Array.from({length:cnt},(_,i)=>({
        id:`${e.from}${e.to}${i}${moIdx}`,from:e.from,to:e.to,
        speed:(0.05+Math.random()*0.09)*playSpeed*(0.5+e.w),
        color:NODES.find(n=>n.id===e.from)?.color||"#fff",
        maxR:cfg.maxR*(0.55+e.w*0.6),opacity:0.5+e.w*0.45,
      }));
    });
  },[moIdx,playSpeed]);

  const periodLabel={
    "1D":"ì¼ê°„","1W":"ì£¼ê°„","2W":"ê²©ì£¼","1M":"ì›”ê°„","3M":"ë¶„ê¸°","6M":"ë°˜ê¸°","1Y":"ì—°ê°„","2Y":"2ë…„"
  };
  const amtUnit=period==="1D"?"$M":period==="1W"||period==="2W"?"$B":"$B";
  const fmt=v=>period==="1D"?`$${Math.round(v*1000)}M`:`$${v}B`;

  return(
    <div style={{background:C.panel,border:`1px solid ${C.border}`,borderRadius:8,overflow:"hidden"}}>

      {/* í—¤ë” */}
      <div style={{padding:"10px 16px",borderBottom:`1px solid ${C.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"}}>
        <div style={{display:"flex",alignItems:"center",gap:12}}>
          <div style={{width:3,height:20,background:C.accent,borderRadius:2}}/>
          <span style={{fontFamily:"Space Grotesk",fontSize:14,fontWeight:700,color:C.accent,letterSpacing:"0.08em"}}>CAPITAL FLOW MONITOR</span>
          <span style={{fontSize:9,color:C.gold,fontFamily:"JetBrains Mono"}}>ê¸€ë¡œë²Œ ìê¸ˆ ì´ë™ ì‹œê°í™” Â· v4.0</span>
        </div>
        <div style={{display:"flex",gap:5}}>
          {["map","chart","table"].map(t=>(
            <button key={t} className={`btn${flowTab===t?" active":""}`} onClick={()=>setFlowTab(t)}>
              {t==="map"?"ğŸ—º MAP":t==="chart"?"ğŸ“Š CHART":"ğŸ“‹ TABLE"}
            </button>
          ))}
        </div>
      </div>

      {/* ì»¨íŠ¸ë¡¤ ë°” */}
      <div style={{padding:"10px 16px",background:"#080d18",borderBottom:`1px solid ${C.border}`,display:"flex",alignItems:"center",gap:14,flexWrap:"wrap"}}>

        {/* ì¬ìƒ */}
        <button onClick={()=>setPlaying(p=>!p)} style={{
          width:34,height:34,borderRadius:"50%",border:`1px solid ${playing?C.accent:C.border}`,
          background:playing?C.accent+"22":"transparent",color:playing?C.accent:C.muted,
          fontSize:13,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0}}>
          {playing?"â¸":"â–¶"}
        </button>

        {/* ê¸°ê°„ í•„í„° */}
        <div style={{display:"flex",gap:4,flexShrink:0}}>
          {["1D","1W","2W","1M","3M","6M","1Y","2Y"].map(p=>(
            <button key={p} className={`btn${period===p?" gold-active":""}`}
              style={{padding:"3px 8px",fontSize:9}}
              onClick={()=>setPeriod(p)}>{p}</button>
          ))}
        </div>

        {/* ì›” ìŠ¬ë¼ì´ë” */}
        <div style={{flex:1,minWidth:200}}>
          <div style={{display:"flex",justifyContent:"space-between",marginBottom:3}}>
            {MONTHS.filter((_,i)=>i%2===0).map((m,i)=>(
              <span key={i} onClick={()=>{setMoIdx(i*2);setPlaying(false);}}
                style={{fontSize:8,color:i*2===moIdx?C.accent:C.dim,fontFamily:"JetBrains Mono",cursor:"pointer",
                  fontWeight:i*2===moIdx?700:400}}>
                {m.label.slice(2)}
              </span>
            ))}
          </div>
          <input type="range" min="0" max={MONTHS.length-1} value={moIdx}
            onChange={e=>{setMoIdx(+e.target.value);setPlaying(false);}}
            style={{accentColor:C.accent}}/>
        </div>

        {/* í˜„ì¬ ì‹œì  ì •ë³´ */}
        <div style={{textAlign:"center",flexShrink:0}}>
          <div style={{fontFamily:"Space Grotesk",fontSize:15,fontWeight:700,color:C.accent}}>{curMo.label}</div>
          <div style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono"}}>{periodLabel[period]} ì´ ì´ë™</div>
          <div style={{fontSize:12,fontWeight:700,color:C.gold,fontFamily:"JetBrains Mono"}}>
            {period==="1D"?`$${(totalFlow*1000/30).toFixed(0)}M`:
             period==="1W"?`$${(totalFlow/4).toFixed(0)}B`:
             period==="2W"?`$${(totalFlow/2).toFixed(0)}B`:
             `$${(totalFlow/1000).toFixed(2)}T`}
          </div>
        </div>

        {/* ì†ë„ */}
        <div style={{flexShrink:0,minWidth:100}}>
          <div style={{display:"flex",justifyContent:"space-between",marginBottom:2}}>
            <span style={{fontSize:8,color:C.muted,fontFamily:"JetBrains Mono"}}>ì¬ìƒ ì†ë„</span>
            <span style={{fontSize:9,color:C.gold,fontFamily:"JetBrains Mono",fontWeight:700}}>{playSpeed.toFixed(1)}Ã—</span>
          </div>
          <input type="range" className="gold" min="0.3" max="5" step="0.1" value={playSpeed}
            onChange={e=>setPlaySpeed(+e.target.value)} style={{accentColor:C.gold}}/>
        </div>
      </div>

      {/* ë©”ì¸ */}
      {flowTab==="map"&&(
        <div style={{display:"flex",height:540}}>

          {/* SVG ì§€ë„ */}
          <div style={{flex:1,position:"relative",overflow:"hidden"}}>
            <svg width="100%" height="100%" style={{display:"block"}} viewBox="0 0 1000 540" preserveAspectRatio="xMidYMid meet">
              <defs>
                <filter id="glow"><feGaussianBlur stdDeviation="4" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
                <filter id="glow-xl"><feGaussianBlur stdDeviation="7" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
                <radialGradient id="bggrad" cx="50%" cy="50%" r="70%">
                  <stop offset="0%" stopColor="#0a1628" stopOpacity="1"/>
                  <stop offset="100%" stopColor="#060810" stopOpacity="1"/>
                </radialGradient>
                <filter id="mapshadow"><feGaussianBlur stdDeviation="2" in="SourceAlpha" result="b"/><feOffset dx="1" dy="1"/><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>
              </defs>

              {/* ë°°ê²½ */}
              <rect width="1000" height="540" fill="url(#bggrad)"/>

              {/* ë°”ë‹¤ ê²©ì */}
              {[100,200,300,400,500,600,700,800,900].map(v=>(
                <line key={`h${v}`} x1={v} y1="0" x2={v} y2="540" stroke="#0d1f35" strokeWidth="0.5"/>
              ))}
              {[100,200,300,400,500].map(v=>(
                <line key={`v${v}`} x1="0" y1={v} x2="1000" y2={v} stroke="#0d1f35" strokeWidth="0.5"/>
              ))}

              {/* ì„¸ê³„ì§€ë„ ëŒ€ë¥™ */}
              {WORLD_PATHS.map((p,i)=>(
                <path key={i} d={p.d} fill={p.color} stroke="#243555" strokeWidth="0.8" opacity="0.85" filter="url(#mapshadow)"/>
              ))}

              {/* ì ë„/ê²½ë„ ì„  */}
              <line x1="0" y1="270" x2="1000" y2="270" stroke="#1a3050" strokeWidth="0.8" strokeDasharray="6 6" opacity="0.5"/>
              <line x1="500" y1="0" x2="500" y2="540" stroke="#1a3050" strokeWidth="0.5" strokeDasharray="4 8" opacity="0.35"/>

              {/* ì—£ì§€ */}
              {edges.map(e=>{
                const f=NODES.find(n=>n.id===e.from),t=NODES.find(n=>n.id===e.to);
                if(!f||!t)return null;
                const cfg=TIER_CFG[e.tier],tc=TIER_COLORS[e.tier];
                const x1=f.x*1000,y1=f.y*540,x2=t.x*1000,y2=t.y*540;
                const mx=(x1+x2)/2+(y2-y1)*0.18,my=(y1+y2)/2-(x2-x1)*0.18;
                const d=`M${x1},${y1} Q${mx},${my} ${x2},${y2}`;
                const isH=hoveredEdge===`${e.from}-${e.to}`;
                const sw=cfg.strokeW*(0.5+e.w*1.2)*(isH?2:1);
                const amtStr=period==="1D"?`$${Math.round(e.amount*1000/30)}M`:fmt(e.amount);
                return(
                  <g key={`${e.from}-${e.to}`}
                    onMouseEnter={()=>setHoveredEdge(`${e.from}-${e.to}`)}
                    onMouseLeave={()=>setHoveredEdge(null)}
                    style={{cursor:"pointer"}}>
                    {(e.tier==="xl"||isH)&&<path d={d} stroke={tc} strokeWidth={sw*3.5} strokeOpacity={0.07} fill="none" filter="url(#glow-xl)"/>}
                    <path d={d} stroke={isH?tc:f.color} strokeWidth={sw}
                      strokeOpacity={isH?0.95:0.28+e.w*0.42} fill="none"
                      strokeDasharray={e.tier==="xl"?"none":e.tier==="lg"?"12 4":"7 6"}/>
                    <text x={mx} y={my} textAnchor="middle" dy="-8"
                      fill={tc} fontSize={isH?cfg.labelSz+2:cfg.labelSz} fontWeight="700"
                      fontFamily="JetBrains Mono,monospace" opacity={isH?1:0.85}
                      filter={e.tier==="xl"||isH?"url(#glow)":"none"}>
                      {amtStr}
                    </text>
                    {isH&&<text x={mx} y={my} textAnchor="middle" dy="6" fill="#fff" fontSize="9" fontFamily="JetBrains Mono,monospace" opacity="0.75">{e.label}</text>}
                  </g>
                );
              })}

              {/* íŒŒí‹°í´ */}
              {particles.current.map(p=>{
                const f=NODES.find(n=>n.id===p.from),t=NODES.find(n=>n.id===p.to);
                if(!f||!t)return null;
                const fn={x:f.x*1,y:f.y*1},tn={x:t.x*1,y:t.y*1};
                return <Particle key={p.id} from={fn} to={tn} speed={p.speed} color={p.color} maxR={p.maxR} opacity={p.opacity}/>;
              })}

              {/* ë…¸ë“œ */}
              {NODES.map(nd=>{
                const px=nd.x*1000,py=nd.y*540;
                const pulse=Math.sin(tick*0.06+nd.x*8)*0.1+0.9;
                const inF=edges.filter(e=>e.to===nd.id).reduce((s,e)=>s+e.amount,0);
                const outF=edges.filter(e=>e.from===nd.id).reduce((s,e)=>s+e.amount,0);
                const net=inF-outF;
                const nc=net>30?C.green:net<-30?C.red:nd.color;
                return(
                  <g key={nd.id}>
                    <circle cx={px} cy={py} r={nd.r*pulse*1.1} fill={nd.color} opacity="0.04"/>
                    <circle cx={px} cy={py} r={nd.r*0.68} fill={nd.color} opacity="0.08" filter="url(#glow)"/>
                    <circle cx={px} cy={py} r={nd.r*0.44} fill="#080d18" stroke={nd.color} strokeWidth="2" strokeOpacity="0.82"/>
                    <circle cx={px} cy={py} r={nd.r*0.52} fill="none" stroke={nc} strokeWidth="2.5" strokeOpacity="0.38" strokeDasharray={`${Math.abs(net)/8} 4`}/>
                    <text x={px} y={py} textAnchor="middle" dy="-5" fill={nd.color} fontSize="11" fontWeight="700" fontFamily="JetBrains Mono,monospace">{nd.label}</text>
                    <text x={px} y={py} textAnchor="middle" dy="7" fill={nd.color} fontSize="8" opacity="0.55" fontFamily="JetBrains Mono,monospace">{nd.en}</text>
                    <text x={px} y={py} textAnchor="middle" dy="18" fill={nc} fontSize="9" fontWeight="700" fontFamily="JetBrains Mono,monospace" opacity="0.9">
                      {net>0?`+${net}B`:net<0?`${net}B`:""}
                    </text>
                  </g>
                );
              })}

              {/* ë²”ë¡€ */}
              <rect x="8" y="8" width="125" height="92" rx="5" fill="#06090f" opacity="0.9"/>
              <text x="16" y="22" fill={C.muted} fontSize="9" fontFamily="JetBrains Mono,monospace" fontWeight="700">ìê¸ˆ ê·œëª¨</text>
              {Object.entries(TIER_CFG).map(([tier,cfg],i)=>{
                const tc=TIER_COLORS[tier];
                const ranges={xl:">$300B",lg:"$150-300B",md:"$80-150B",sm:"<$80B"};
                return(
                  <g key={tier} transform={`translate(12,${30+i*17})`}>
                    <circle r={cfg.maxR*0.7} cx="7" cy="4" fill={tc} opacity="0.9"/>
                    <line x1="16" y1="4" x2="34" y2="4" stroke={tc} strokeWidth={cfg.strokeW*0.8} opacity="0.75"/>
                    <text x="38" y="8" fill={tc} fontSize="9" fontFamily="JetBrains Mono,monospace">{ranges[tier]}</text>
                  </g>
                );
              })}

              {/* ê¸°ê°„ í‘œì‹œ */}
              <rect x="870" y="8" width="122" height="28" rx="4" fill="#06090f" opacity="0.9"/>
              <text x="931" y="26" textAnchor="middle" fill={C.gold} fontSize="11" fontWeight="700" fontFamily="JetBrains Mono,monospace">{curMo.label} Â· {periodLabel[period]}</text>
            </svg>
          </div>

          {/* ì‚¬ì´ë“œ ë­í‚¹ */}
          <div style={{width:215,borderLeft:`1px solid ${C.border}`,overflowY:"auto",background:"#080d18",padding:"10px 8px"}}>
            <div style={{fontSize:10,color:C.muted,fontFamily:"JetBrains Mono",fontWeight:700,letterSpacing:"0.1em",marginBottom:8}}>
              TOP FLOWS Â· {curMo.label}
            </div>
            {[...edges].sort((a,b)=>b.amount-a.amount).map((e,i)=>{
              const f=NODES.find(n=>n.id===e.from),t=NODES.find(n=>n.id===e.to);
              const tc=TIER_COLORS[e.tier];
              const prevAmt=e.amounts[(moIdx+MONTHS.length-1)%MONTHS.length];
              const delta=e.amounts[moIdx]-prevAmt;
              return(
                <div key={`${e.from}-${e.to}`} style={{marginBottom:7,padding:"7px 8px",background:C.panel,borderRadius:5,border:`1px solid ${tc}33`}}>
                  <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:3}}>
                    <span style={{fontSize:9,color:f?.color,fontFamily:"JetBrains Mono",fontWeight:700,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:130}}>
                      {i+1}. {f?.label}â†’{t?.label}
                    </span>
                    <span style={{fontSize:8,color:tc,fontWeight:700}}>{TIER_CFG[e.tier].badge}</span>
                  </div>
                  <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4}}>
                    <span style={{fontSize:13,fontWeight:700,color:tc,fontFamily:"JetBrains Mono"}}>{fmt(e.amount)}</span>
                    <span style={{fontSize:9,color:delta>=0?C.green:C.red,fontFamily:"JetBrains Mono"}}>
                      {delta>=0?"â–²":"â–¼"}${Math.abs(delta)}B
                    </span>
                  </div>
                  <div style={{height:3,background:C.border,borderRadius:2,marginBottom:4}}>
                    <div style={{width:`${(e.amount/maxAmt)*100}%`,height:"100%",background:`linear-gradient(90deg,${f?.color}88,${tc})`,borderRadius:2}}/>
                  </div>
                  <Spark data={e.amounts} width={195} height={22}/>
                  <div style={{fontSize:8,color:C.dim,fontFamily:"JetBrains Mono",marginTop:2}}>{e.label}</div>
                </div>
              );
            })}
          </div>
        </div>
      )}

      {/* CHART íƒ­ */}
      {flowTab==="chart"&&(
        <div style={{height:540,overflowY:"auto",padding:14}}>
          <div style={{fontSize:11,color:C.muted,fontFamily:"JetBrains Mono",marginBottom:10,fontWeight:700}}>
            24ê°œì›” ì¶”ì´ â€” í´ë¦­í•˜ë©´ í•´ë‹¹ ì›”ë¡œ ì´ë™ (ë‹¨ìœ„: $B)
          </div>
          <div style={{display:"flex",flexDirection:"column",gap:12}}>
            {[...edges].sort((a,b)=>b.amount-a.amount).map(e=>{
              const f=NODES.find(n=>n.id===e.from),t=NODES.find(n=>n.id===e.to);
              const tc=TIER_COLORS[e.tier];
              const maxV=Math.max(...e.amounts);
              return(
                <div key={`${e.from}-${e.to}`} style={{background:"#080d18",borderRadius:6,padding:"10px 12px",border:`1px solid ${tc}33`}}>
                  <div style={{display:"flex",justifyContent:"space-between",marginBottom:6}}>
                    <span style={{fontSize:10,color:f?.color,fontFamily:"JetBrains Mono",fontWeight:700}}>{f?.label} â†’ {t?.label}</span>
                    <span style={{fontSize:9,color:C.muted}}>{e.label}</span>
                  </div>
                  <div style={{display:"flex",alignItems:"flex-end",gap:2,height:44}}>
                    {e.amounts.map((v,i)=>{
                      const bh=(v/maxV)*40;
                      const isCur=i===moIdx;
                      return(
                        <div key={i} title={`${MONTHS[i].label}: $${v}B`}
                          style={{flex:1,display:"flex",flexDirection:"column",alignItems:"center",cursor:"pointer"}}
                          onClick={()=>{setMoIdx(i);setFlowTab("map");}}>
                          <div style={{width:"100%",height:bh,background:isCur?tc:tc+"44",borderRadius:"2px 2px 0 0",transition:"height .3s",boxShadow:isCur?`0 0 8px ${tc}88`:"none"}}/>
                        </div>
                      );
                    })}
                  </div>
                  <div style={{display:"flex",justifyContent:"space-between",marginTop:2}}>
                    {MONTHS.filter((_,i)=>i%4===0).map((m,i)=>(
                      <span key={i} style={{fontSize:7,color:C.dim,fontFamily:"JetBrains Mono"}}>{m.label.slice(2)}</span>
                    ))}
                  </div>
                </div>
              );
            })}
          </div>
        </div>
      )}

      {/* TABLE íƒ­ */}
      {flowTab==="table"&&(
        <div style={{height:540,overflowX:"auto",overflowY:"auto"}}>
          <table style={{width:"100%",borderCollapse:"collapse",fontFamily:"JetBrains Mono",fontSize:9,minWidth:900}}>
            <thead>
              <tr style={{background:"#080d18",position:"sticky",top:0,zIndex:1}}>
                <th style={{padding:"8px 12px",textAlign:"left",color:C.muted,fontSize:9,fontWeight:700,borderBottom:`1px solid ${C.border}`,minWidth:160}}>ê²½ë¡œ</th>
                {MONTHS.map((m,i)=>(
                  <th key={i} onClick={()=>setMoIdx(i)}
                    style={{padding:"6px 4px",textAlign:"right",color:i===moIdx?C.accent:C.muted,fontSize:8,fontWeight:i===moIdx?700:400,borderBottom:`1px solid ${C.border}`,cursor:"pointer",minWidth:40,background:i===moIdx?C.accent+"11":"transparent"}}>
                    {m.label.slice(2)}
                  </th>
                ))}
                <th style={{padding:"8px 8px",textAlign:"right",color:C.gold,fontSize:9,fontWeight:700,borderBottom:`1px solid ${C.border}`}}>í‰ê· </th>
              </tr>
            </thead>
            <tbody>
              {[...EDGES_DATA].sort((a,b)=>b.amounts[moIdx]-a.amounts[moIdx]).map((e,idx)=>{
                const f=NODES.find(n=>n.id===e.from),t=NODES.find(n=>n.id===e.to);
                const tc=TIER_COLORS[e.tier];
                const avg=Math.round(e.amounts.reduce((s,v)=>s+v,0)/24);
                return(
                  <tr key={`${e.from}-${e.to}`} style={{borderBottom:`1px solid ${C.border}22`,background:idx%2===0?C.panel:C.bg}}>
                    <td style={{padding:"6px 12px"}}>
                      <span style={{color:f?.color,fontWeight:700}}>{f?.label}</span>
                      <span style={{color:C.muted}}> â†’ </span>
                      <span style={{color:t?.color||C.text}}>{t?.label}</span>
                    </td>
                    {e.amounts.map((v,i)=>{
                      const isCur=i===moIdx,isHi=v===Math.max(...e.amounts),isLo=v===Math.min(...e.amounts);
                      return(
                        <td key={i} onClick={()=>setMoIdx(i)}
                          style={{padding:"6px 4px",textAlign:"right",cursor:"pointer",
                            color:isCur?C.accent:isHi?C.green:isLo?C.red:C.text,
                            background:isCur?`${C.accent}11`:"transparent",fontWeight:isCur||isHi?700:400}}>
                          {v}
                        </td>
                      );
                    })}
                    <td style={{padding:"6px 8px",textAlign:"right",color:C.gold,fontWeight:700}}>{avg}</td>
                  </tr>
                );
              })}
            </tbody>
          </table>
        </div>
      )}
    </div>
  );
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ìì‚° ìƒê´€ê´€ê³„ ë„¤íŠ¸ì›Œí¬
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function CorrelationMatrix(){
  const [hover,setHover]=useState(null);
  const sz=52;
  const gap=2;
  const n=CORR_ASSETS.length;
  const total=(sz+gap)*n;
  return(
    <div style={{background:C.panel,border:`1px solid ${C.border}`,borderRadius:6,overflow:"hidden"}}>
      <div style={{padding:"8px 14px",borderBottom:`1px solid ${C.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"}}>
        <div style={{display:"flex",alignItems:"center",gap:10}}>
          <div style={{width:3,height:18,background:C.purple,borderRadius:2}}/>
          <span style={{fontFamily:"Space Grotesk",fontSize:11,fontWeight:700,color:C.purple,letterSpacing:"0.1em",textTransform:"uppercase"}}>ìì‚° ìƒê´€ê´€ê³„ ë§¤íŠ¸ë¦­ìŠ¤</span>
          <span style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono"}}>Asset Correlation Matrix</span>
        </div>
        <span style={{fontSize:8,color:C.dim,fontFamily:"JetBrains Mono"}}>ì¶”ì •ê°’ Â· 12ê°œì›” ê¸°ì¤€</span>
      </div>
      <div style={{padding:"12px 14px",overflowX:"auto"}}>
        {/* ìƒ‰ìƒ ë²”ë¡€ */}
        <div style={{display:"flex",alignItems:"center",gap:6,marginBottom:10}}>
          <span style={{fontSize:8,color:C.muted,fontFamily:"JetBrains Mono"}}>ìƒê´€ê³„ìˆ˜:</span>
          {[[-1.0,"#ff1744"],[-0.6,"#f44336"],[-0.2,"#ff7043"],[0,"#5a6a7a"],[0.2,"#8bc34a"],[0.6,"#4caf50"],[1.0,"#00e676"]].map(([v,col])=>(
            <div key={v} style={{display:"flex",alignItems:"center",gap:3}}>
              <div style={{width:12,height:12,borderRadius:2,background:col,opacity:0.85}}/>
              <span style={{fontSize:8,color:col,fontFamily:"JetBrains Mono"}}>{v>0?"+":""}{v}</span>
            </div>
          ))}
          {hover&&(
            <div style={{marginLeft:"auto",padding:"3px 10px",background:C.bg,borderRadius:4,border:`1px solid ${C.border}`}}>
              <span style={{fontSize:9,color:C.text,fontFamily:"JetBrains Mono"}}>
                <span style={{color:corrColor(hover.v)}}>{CORR_ASSETS[hover.r]}</span>
                <span style={{color:C.muted}}> & </span>
                <span style={{color:corrColor(hover.v)}}>{CORR_ASSETS[hover.c]}</span>
                <span style={{color:C.muted}}>: </span>
                <span style={{color:corrColor(hover.v),fontWeight:700}}>{hover.v>0?"+":""}{hover.v.toFixed(2)}</span>
                <span style={{color:C.muted,fontSize:8}}>
                  {" "}({hover.v>0.7?"ê°•í•œ ì–‘(+) ìƒê´€":hover.v>0.3?"ì¤‘ê°„ ì–‘(+) ìƒê´€":hover.v>-0.3?"ê±°ì˜ ë¬´ê´€":hover.v>-0.7?"ì¤‘ê°„ ìŒ(-) ìƒê´€":"ê°•í•œ ìŒ(-) ìƒê´€"})
                </span>
              </span>
            </div>
          )}
        </div>

        <div style={{display:"flex"}}>
          {/* Yì¶• ë ˆì´ë¸” */}
          <div style={{display:"flex",flexDirection:"column",marginRight:4,marginTop:sz+gap+2}}>
            {CORR_ASSETS.map((a,i)=>(
              <div key={i} style={{height:sz+gap,display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:6}}>
                <span style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono",whiteSpace:"nowrap"}}>{a}</span>
              </div>
            ))}
          </div>
          <div>
            {/* Xì¶• ë ˆì´ë¸” */}
            <div style={{display:"flex",marginBottom:4}}>
              {CORR_ASSETS.map((a,i)=>(
                <div key={i} style={{width:sz+gap,overflow:"hidden",display:"flex",alignItems:"flex-end",justifyContent:"center",paddingBottom:4}}>
                  <span style={{fontSize:8,color:C.muted,fontFamily:"JetBrains Mono",writingMode:"vertical-rl",transform:"rotate(180deg)",whiteSpace:"nowrap"}}>{a}</span>
                </div>
              ))}
            </div>
            {/* ë§¤íŠ¸ë¦­ìŠ¤ */}
            {CORR_MATRIX.map((row,r)=>(
              <div key={r} style={{display:"flex",gap:gap+"px",marginBottom:gap+"px"}}>
                {row.map((v,c)=>{
                  const col=corrColor(v);
                  const isH=hover&&hover.r===r&&hover.c===c;
                  return(
                    <div key={c}
                      onMouseEnter={()=>setHover({r,c,v})}
                      onMouseLeave={()=>setHover(null)}
                      style={{width:sz,height:sz,background:col+"33",border:`1px solid ${isH?col:col+"55"}`,
                        borderRadius:3,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",
                        cursor:"pointer",transition:"all .15s",
                        boxShadow:isH?`0 0 10px ${col}66`:"none",
                        transform:isH?"scale(1.08)":"scale(1)"}}>
                      <div style={{width:"70%",height:"70%",borderRadius:3,background:col,opacity:r===c?1:0.25+Math.abs(v)*0.6}}/>
                      <span style={{fontSize:8,color:col,fontFamily:"JetBrains Mono",fontWeight:700,marginTop:2}}>{v>0?"+":""}{v.toFixed(2)}</span>
                    </div>
                  );
                })}
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì•„ë¹„íŠ¸ë¼ì§€ ê¸°íšŒ íŒ¨ë„
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function ArbitragePanel(){
  const typeColors={crypto:C.red,commodity:C.gold,rate:C.accent,equity:C.green,fx:C.purple,volatility:"#bb86fc"};
  const typeLabels={crypto:"ì•”í˜¸í™”í",commodity:"ì›ìì¬",rate:"ê¸ˆë¦¬",equity:"ì£¼ì‹",fx:"ì™¸í™˜",volatility:"ë³€ë™ì„±"};
  const [filter,setFilter]=useState("all");
  const filtered=filter==="all"?ARB_DATA:ARB_DATA.filter(a=>a.type===filter);

  return(
    <div style={{background:C.panel,border:`1px solid ${C.border}`,borderRadius:6,overflow:"hidden"}}>
      <div style={{padding:"8px 14px",borderBottom:`1px solid ${C.border}`,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:6}}>
        <div style={{display:"flex",alignItems:"center",gap:10}}>
          <div style={{width:3,height:18,background:C.gold,borderRadius:2}}/>
          <span style={{fontFamily:"Space Grotesk",fontSize:11,fontWeight:700,color:C.gold,letterSpacing:"0.1em",textTransform:"uppercase"}}>ì•„ë¹„íŠ¸ë¼ì§€ ê¸°íšŒ</span>
          <span style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono"}}>Cross-Market Arbitrage Opportunities</span>
        </div>
        <div style={{display:"flex",gap:4}}>
          {["all","rate","crypto","commodity","equity","fx"].map(t=>(
            <button key={t} className={`btn${filter===t?" active":""}`}
              style={{padding:"2px 8px",fontSize:8}}
              onClick={()=>setFilter(t)}>
              {t==="all"?"ì „ì²´":typeLabels[t]||t}
            </button>
          ))}
        </div>
      </div>
      <div style={{padding:"10px 12px",display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(280px,1fr))",gap:8}}>
        {filtered.map(a=>{
          const tc=typeColors[a.type]||C.accent;
          const ratio=a.direction==="up"?a.value/a.threshold:a.threshold/a.value;
          const opportunity=ratio>0.9;
          const pct=Math.min((ratio)*100,100);
          return(
            <div key={a.name} style={{
              padding:"10px 12px",background:C.bg,borderRadius:6,
              border:`1px solid ${opportunity?tc+"66":C.border}`,
              boxShadow:opportunity?`0 0 12px ${tc}22`:"none",
            }}>
              <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:6}}>
                <div>
                  <div style={{fontSize:11,color:tc,fontWeight:700,fontFamily:"JetBrains Mono"}}>{a.name}</div>
                  <div style={{fontSize:8,color:C.muted,fontFamily:"JetBrains Mono"}}>{a.en}</div>
                </div>
                <div style={{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:3}}>
                  <span style={{fontSize:8,color:tc,background:tc+"22",padding:"1px 6px",borderRadius:3,fontFamily:"JetBrains Mono",fontWeight:700}}>
                    {typeLabels[a.type]}
                  </span>
                  {opportunity&&<span style={{fontSize:8,color:C.green,background:C.green+"22",padding:"1px 6px",borderRadius:3,fontFamily:"JetBrains Mono",fontWeight:700,animation:"none"}}>âš¡ ê¸°íšŒ í¬ì°©</span>}
                </div>
              </div>
              <div style={{display:"flex",alignItems:"baseline",gap:8,marginBottom:6}}>
                <span style={{fontSize:20,fontWeight:700,color:tc,fontFamily:"JetBrains Mono"}}>{a.value}{a.unit}</span>
                <span style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono"}}>ê¸°ì¤€ì„ : {a.threshold}{a.unit}</span>
              </div>
              {/* í”„ë¡œê·¸ë ˆìŠ¤ ë°” */}
              <div style={{height:4,background:C.border,borderRadius:2,marginBottom:6,overflow:"hidden"}}>
                <div style={{width:`${pct}%`,height:"100%",background:opportunity?`linear-gradient(90deg,${tc}88,${tc})`:`${tc}55`,borderRadius:2,transition:"width .5s"}}/>
              </div>
              <div style={{display:"flex",justifyContent:"space-between",alignItems:"center"}}>
                <span style={{fontSize:8,color:C.dim,fontFamily:"JetBrains Mono"}}>{a.desc}</span>
                <span style={{fontSize:9,color:opportunity?C.green:C.muted,fontFamily:"JetBrains Mono",fontWeight:700}}>{pct.toFixed(0)}%</span>
              </div>
            </div>
          );
        })}
      </div>
    </div>
  );
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FX + SPARKLINE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function FXPanel(){
  const [rates,setRates]=useState({KRW:1368.5,JPY:149.2,EUR:0.918,GBP:0.782,CNY:7.24,MXN:17.85,AUD:1.562,CAD:1.382});
  const [live,setLive]=useState(false);
  const r=useRef(null);
  function genHist(base,vol,n=24){
    if(!r.current)r.current=seededR(Math.round(base*100));
    return Array.from({length:n},(_,i)=>+(base*(1+(r.current()-0.5)*vol*2)).toFixed(base>10?1:4));
  }
  const [hist,setHist]=useState({});
  useEffect(()=>{
    const go=async()=>{
      try{
        const res=await fetch("https://api.exchangerate-api.com/v4/latest/USD");
        if(!res.ok)return;
        const d=await res.json();
        setRates({KRW:d.rates.KRW,JPY:d.rates.JPY,EUR:d.rates.EUR,GBP:d.rates.GBP,CNY:d.rates.CNY,MXN:d.rates.MXN,AUD:d.rates.AUD,CAD:d.rates.CAD});
        setLive(true);
      }catch{}
    };
    go();const iv=setInterval(go,60000);return()=>clearInterval(iv);
  },[]);
  useEffect(()=>{
    if(rates.KRW!==1368.5){
      setHist({
        "USD/KRW":genHist(rates.KRW,0.025),"USD/JPY":genHist(rates.JPY,0.02),
        "EUR/USD":genHist(1/rates.EUR,0.018),"GBP/USD":genHist(1/rates.GBP,0.022),
        "USD/CNY":genHist(rates.CNY,0.015),"USD/MXN":genHist(rates.MXN,0.035),
        "AUD/USD":genHist(1/rates.AUD,0.022),"USD/CAD":genHist(rates.CAD,0.018),
      });
    }
  },[rates]);
  const pairs=[
    {p:"USD/KRW",v:rates.KRW,f:"ğŸ‡ºğŸ‡¸ğŸ‡°ğŸ‡·",dec:1},{p:"USD/JPY",v:rates.JPY,f:"ğŸ‡ºğŸ‡¸ğŸ‡¯ğŸ‡µ",dec:2},
    {p:"EUR/USD",v:1/rates.EUR,f:"ğŸ‡ªğŸ‡ºğŸ‡ºğŸ‡¸",dec:4},{p:"GBP/USD",v:1/rates.GBP,f:"ğŸ‡¬ğŸ‡§ğŸ‡ºğŸ‡¸",dec:4},
    {p:"USD/CNY",v:rates.CNY,f:"ğŸ‡ºğŸ‡¸ğŸ‡¨ğŸ‡³",dec:4},{p:"USD/MXN",v:rates.MXN,f:"ğŸ‡ºğŸ‡¸ğŸ‡²ğŸ‡½",dec:4},
    {p:"AUD/USD",v:1/rates.AUD,f:"ğŸ‡¦ğŸ‡ºğŸ‡ºğŸ‡¸",dec:4},{p:"USD/CAD",v:rates.CAD,f:"ğŸ‡ºğŸ‡¸ğŸ‡¨ğŸ‡¦",dec:4},
  ];
  return(
    <div style={{padding:"8px 10px",display:"flex",flexDirection:"column",gap:5}}>
      {pairs.map(x=>{
        const sp=hist[x.p];const last=sp?sp[sp.length-1]:null,first=sp?sp[0]:null;
        const chg=last&&first?((last-first)/first*100):0;
        return(
          <div key={x.p} style={{display:"flex",alignItems:"center",gap:6,padding:"5px 8px",background:C.bg,borderRadius:4,border:`1px solid ${C.border}`}}>
            <span style={{fontSize:11}}>{x.f}</span>
            <span style={{color:C.accent,fontFamily:"JetBrains Mono",fontSize:10,fontWeight:700,minWidth:72}}>{x.p}</span>
            <span style={{color:C.text,fontFamily:"JetBrains Mono",fontSize:11,fontWeight:700,minWidth:68}}>{parseFloat(x.v).toFixed(x.dec)}</span>
            {sp&&<Spark data={sp} width={72} height={24}/>}
            {sp&&<span style={{fontSize:9,color:chg>=0?C.green:C.red,fontFamily:"JetBrains Mono",minWidth:44,textAlign:"right"}}>{chg>=0?"â–²":"â–¼"}{Math.abs(chg).toFixed(2)}%</span>}
          </div>
        );
      })}
      <div style={{fontSize:9,color:live?C.green:C.muted,textAlign:"right",fontFamily:"JetBrains Mono"}}>{live?"â— LIVE Â· ExchangeRate-API":"â—‹ ì—°ê²° ì¤‘..."}</div>
    </div>
  );
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CRYPTO LIVE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function CryptoLive(){
  const [data,setData]=useState([
    {n:"BTC",p:85420,c:2.3},{n:"ETH",p:2180,c:1.8},{n:"USDT",p:1.0,c:0.0},{n:"XRP",p:2.18,c:-1.2},{n:"SOL",p:142.5,c:3.1},
  ]);
  const [live,setLive]=useState(false);
  useEffect(()=>{
    const go=async()=>{
      try{
        const r=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,tether,ripple,solana&vs_currencies=usd&include_24hr_change=true");
        if(!r.ok)return;
        const d=await r.json();
        setData([{n:"BTC",p:d.bitcoin?.usd,c:d.bitcoin?.usd_24h_change},{n:"ETH",p:d.ethereum?.usd,c:d.ethereum?.usd_24h_change},{n:"USDT",p:d.tether?.usd,c:d.tether?.usd_24h_change},{n:"XRP",p:d.ripple?.usd,c:d.ripple?.usd_24h_change},{n:"SOL",p:d.solana?.usd,c:d.solana?.usd_24h_change}]);
        setLive(true);
      }catch{}
    };
    go();const iv=setInterval(go,30000);return()=>clearInterval(iv);
  },[]);
  return(
    <div style={{padding:"8px 10px",display:"flex",flexDirection:"column",gap:5}}>
      {data.map(x=>(
        <div key={x.n} style={{display:"flex",justifyContent:"space-between",padding:"5px 8px",background:C.bg,borderRadius:4,border:`1px solid ${C.border}`}}>
          <span style={{color:C.gold,fontFamily:"JetBrains Mono",fontSize:10,fontWeight:700}}>{x.n}</span>
          <span style={{color:C.text,fontFamily:"JetBrains Mono",fontSize:10}}>${x.p<10?x.p?.toFixed(4):x.p?.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</span>
          <span style={{color:x.c>=0?C.green:C.red,fontSize:9}}>{x.c>=0?"â–²":"â–¼"}{Math.abs(x.c||0).toFixed(2)}%</span>
        </div>
      ))}
      <div style={{fontSize:9,color:live?C.green:C.muted,textAlign:"right",fontFamily:"JetBrains Mono"}}>{live?"â— LIVE Â· CoinGecko":"â—‹ ì—°ê²° ì¤‘..."}</div>
    </div>
  );
}

/* íŒ¨ë„ ë˜í¼ */
function Box({title,badge,children,style}){
  return(
    <div style={{background:C.panel,border:`1px solid ${C.border}`,borderRadius:6,overflow:"hidden",...style}}>
      <div style={{fontFamily:"'Space Grotesk',sans-serif",fontSize:11,fontWeight:700,letterSpacing:"0.1em",textTransform:"uppercase",color:C.muted,padding:"8px 12px",borderBottom:`1px solid ${C.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"}}>
        <span>{title}</span>{badge&&<span>{badge}</span>}
      </div>
      {children}
    </div>
  );
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   APP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* â•â•â• MACRO INTELLIGENCE DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const COUNTRIES=[
  {id:"us",name:"ë¯¸êµ­",    flag:"ğŸ‡ºğŸ‡¸",gdpGrowth:2.8,cpi:3.2,unemployment:3.9,pmi:51.6,policyRate:4.25,mktRate10y:4.52,currentAccount:-3.1,debtGDP:122,nextMeeting:"2025-03-19",cbName:"Fed",stance:"ì¤‘ë¦½â†’ì™„í™”",stanceDir:1,color:"#00d4ff",yields:[4.05,4.11,4.18,4.25,4.38,4.52,4.63,4.73]},
  {id:"cn",name:"ì¤‘êµ­",    flag:"ğŸ‡¨ğŸ‡³",gdpGrowth:4.6,cpi:0.4,unemployment:5.1,pmi:50.2,policyRate:3.10,mktRate10y:2.35,currentAccount:1.8, debtGDP:88, nextMeeting:"2025-02-20",cbName:"PBOC",stance:"ì™„í™”ì ",stanceDir:1,color:"#ff4444",yields:[1.80,1.92,2.02,2.10,2.20,2.35,2.48,2.62]},
  {id:"eu",name:"ìœ ë¡œì¡´",  flag:"ğŸ‡ªğŸ‡º",gdpGrowth:0.8,cpi:2.3,unemployment:6.2,pmi:47.3,policyRate:2.65,mktRate10y:2.65,currentAccount:2.8, debtGDP:91, nextMeeting:"2025-03-06",cbName:"ECB",stance:"ì™„í™” ì¤‘",stanceDir:1,color:"#7c6af5",yields:[2.05,2.18,2.28,2.38,2.50,2.65,2.78,2.95]},
  {id:"jp",name:"ì¼ë³¸",    flag:"ğŸ‡¯ğŸ‡µ",gdpGrowth:1.2,cpi:2.8,unemployment:2.4,pmi:49.0,policyRate:0.50,mktRate10y:1.05,currentAccount:3.5, debtGDP:264,nextMeeting:"2025-03-19",cbName:"BOJ",stance:"ê¸´ì¶• ì‹œì‘",stanceDir:-1,color:"#ff7043",yields:[0.08,0.15,0.25,0.38,0.60,1.05,1.35,1.55]},
  {id:"kr",name:"í•œêµ­",    flag:"ğŸ‡°ğŸ‡·",gdpGrowth:2.1,cpi:2.0,unemployment:3.0,pmi:49.8,policyRate:2.75,mktRate10y:3.02,currentAccount:3.2, debtGDP:54, nextMeeting:"2025-02-25",cbName:"BOK",stance:"ì™„í™” ì¤‘",stanceDir:1,color:"#ff9800",yields:[2.40,2.58,2.70,2.82,2.95,3.02,3.10,3.18]},
  {id:"tw",name:"ëŒ€ë§Œ",    flag:"ğŸ‡¹ğŸ‡¼",gdpGrowth:3.8,cpi:1.8,unemployment:3.5,pmi:52.1,policyRate:2.00,mktRate10y:1.95,currentAccount:14.2,debtGDP:27, nextMeeting:"2025-03-27",cbName:"CBC",stance:"ì¤‘ë¦½",stanceDir:0,color:"#4caf50",yields:[0.90,1.10,1.30,1.55,1.75,1.95,2.10,2.25]},
  {id:"uk",name:"ì˜êµ­",    flag:"ğŸ‡¬ğŸ‡§",gdpGrowth:0.5,cpi:2.9,unemployment:4.4,pmi:48.8,policyRate:4.75,mktRate10y:4.58,currentAccount:-3.5,debtGDP:102,nextMeeting:"2025-03-20",cbName:"BOE",stance:"ì‹ ì¤‘í•œ ì™„í™”",stanceDir:1,color:"#bb86fc",yields:[3.90,4.05,4.18,4.35,4.45,4.58,4.65,4.72]},
  {id:"ru",name:"ëŸ¬ì‹œì•„",  flag:"ğŸ‡·ğŸ‡º",gdpGrowth:3.5,cpi:9.5,unemployment:2.3,pmi:53.2,policyRate:21.0,mktRate10y:18.5,currentAccount:4.2, debtGDP:19, nextMeeting:"2025-03-21",cbName:"CBR",stance:"ì´ˆê¸´ì¶•",stanceDir:-1,color:"#f44336",yields:[14,15.5,16.8,17.5,18,18.5,19,19.5]},
];

const REGIME_INDICATORS=[
  {name:"US ìˆ˜ìµë¥ ê³¡ì„ (2Y-10Y)",key:"yield_curve",value:-0.34,unit:"%p",threshold:0,   signal:"ê²½ê¸°ì¹¨ì²´ ê²½ë³´",  bad:true},
  {name:"ê¸€ë¡œë²Œ PMI í•©ì„±",      key:"pmi",         value:50.8, unit:"",   threshold:50, signal:"í™•ì¥ êµ­ë©´",      bad:false},
  {name:"ë‹¬ëŸ¬ì¸ë±ìŠ¤ DXY",       key:"dxy",         value:104.2,unit:"",   threshold:100,signal:"ë‹¬ëŸ¬ ê°•ì„¸",       bad:false},
  {name:"VIX ê³µí¬ì§€ìˆ˜",         key:"vix",         value:18.4, unit:"",   threshold:25, signal:"ì €ë³€ë™ì„± ì–‘í˜¸",  bad:true},
  {name:"WTI ì›ìœ ",             key:"wti",         value:68.5, unit:"$",  threshold:90, signal:"ì—ë„ˆì§€ ì•ˆì •",    bad:true},
  {name:"ê¸ˆ $3,018",            key:"gold",        value:3018, unit:"$",  threshold:2500,signal:"ì•ˆì „ìì‚° ì„ í˜¸", bad:false},
  {name:"BTC ê³µí¬íƒìš•(62)",     key:"btc_fg",      value:62,   unit:"",   threshold:50, signal:"íƒìš• êµ¬ê°„",      bad:false},
  {name:"ë¯¸ì¤‘ ê¸´ì¥ì§€ìˆ˜",        key:"geopol",      value:72,   unit:"/100",threshold:60,signal:"ì§€ì •í•™ ê³ ìœ„í—˜",  bad:true},
  {name:"ê¸€ë¡œë²Œ ì¸í”Œë ˆì´ì…˜",    key:"inflation",   value:3.8,  unit:"%",  threshold:3.0,signal:"ì¸í”Œë ˆ ì™„í™” ì¤‘", bad:true},
  {name:"US ì‹¤ì—…ë¥ ",            key:"employment",  value:3.9,  unit:"%",  threshold:5.0,signal:"ì™„ì „ê³ ìš© ìœ ì§€",  bad:true},
];

const SIGNALS=[
  {asset:"ë¯¸êµ­ ì£¼ì‹ (S&P500Â·NASDAQ)",icon:"ğŸ“ˆ",color:"#00d4ff",signal:"OVERWEIGHT",score:72,
   reasons:[{f:"AI ì„¤ë¹„íˆ¬ì ì‚¬ì´í´",i:"+",s:3,n:"ë¹…í…Œí¬ CapEx í™•ëŒ€ ì§€ì†"},{f:"ì—°ì¤€ ì™„í™” ê¸°ëŒ€",i:"+",s:3,n:"2025ë…„ 2~3íšŒ ì¸í•˜ ê°€ê²© ë°˜ì˜"},{f:"ê³ ìš©Â·ì†Œë¹„ ê²¬ì¡°",i:"+",s:2,n:"ì‹¤ì—…ë¥  3.9% ìœ ì§€"},{f:"ë°¸ë¥˜ì—ì´ì…˜ ë¶€ë‹´(P/E 22x)",i:"-",s:2,n:"ì—­ì‚¬ì  ê³ í‰ê°€"},{f:"ìˆ˜ìµë¥ ê³¡ì„  ì—­ì „",i:"-",s:2,n:"ê²½ê¸°ì¹¨ì²´ ì„ í–‰ ì‹ í˜¸"}],
   hint:"í•µì‹¬ ê¸°ìˆ ì£¼(NVDAÂ·MSFTÂ·META) ë¹„ì¤‘ ìœ ì§€. ì¡°ì • ì‹œ ë§¤ìˆ˜. S&P 5,000 ì§€ì§€ì„  í™•ì¸."},
  {asset:"í•œêµ­ ì£¼ì‹ (KOSPIÂ·KOSDAQ)",icon:"ğŸ‡°ğŸ‡·",color:"#ff9800",signal:"NEUTRALâ†’BUY",score:54,
   reasons:[{f:"ì½”ë¦¬ì•„ ë””ìŠ¤ì¹´ìš´íŠ¸(PBR 0.85x)",i:"+",s:3,n:"ë°¸ë¥˜ì—… ì •ì±… ìˆ˜í˜œ ê¸°ëŒ€"},{f:"ë°˜ë„ì²´ ì—…ì‚¬ì´í´ ì§„ì…",i:"+",s:3,n:"HBMÂ·AIë°˜ë„ì²´ ìˆ˜ìš” í­ë°œ"},{f:"ì™¸êµ­ì¸ ìˆœë§¤ë„ ì§€ì†",i:"-",s:2,n:"ë‹¬ëŸ¬ ê°•ì„¸â†’EM ìê¸ˆ ì´íƒˆ"},{f:"ì •ì¹˜ ë¶ˆí™•ì‹¤ì„±",i:"-",s:2,n:"ê³„ì—„ ì‚¬íƒœ í›„ ì‹ ë¢°ë„ ì•½í™”"}],
   hint:"ì‚¼ì„±ì „ì(005930)Â·SKí•˜ì´ë‹‰ìŠ¤(000660) ì €ì  ë¶„í•  ë§¤ìˆ˜. KOSPI 2,500 ê°•í•œ ì§€ì§€ì„ ."},
  {asset:"ê¸ˆ (Gold)",icon:"ğŸª™",color:"#ffd700",signal:"OVERWEIGHT",score:78,
   reasons:[{f:"ì¤‘ì•™ì€í–‰ ëŒ€ê·œëª¨ ë§¤ì§‘",i:"+",s:3,n:"ì¤‘êµ­Â·ì¸ë„Â·ëŸ¬ì‹œì•„ ì¤€ë¹„ìì‚° ì „í™˜"},{f:"ì§€ì •í•™ ë¦¬ìŠ¤í¬ ê³ ì¡°",i:"+",s:3,n:"ë¯¸ì¤‘ íŒ¨ê¶Œì „ìŸÂ·ì¤‘ë™ ê¸´ì¥"},{f:"$3,000 ëŒíŒŒ ëª¨ë©˜í…€",i:"+",s:2,n:"ê¸°ìˆ ì  ëŒíŒŒâ†’ì¶”ê°€ ìƒìŠ¹ ì—¬ì§€"},{f:"ì¸í”Œë ˆ í—¤ì§€",i:"+",s:2,n:"ê´€ì„¸ë°œ 2ì°¨ ì¸í”Œë ˆ ìš°ë ¤"}],
   hint:"í¬íŠ¸í´ë¦¬ì˜¤ 10~15% ê¸ˆ í¸ì… ê¶Œì¥. ETF(GLDÂ·IAU) ë˜ëŠ” ê¸ˆí†µì¥. ë¶„í•  ë§¤ìˆ˜."},
  {asset:"ë¹„íŠ¸ì½”ì¸ (BTC)",icon:"â‚¿",color:"#ff6b6b",signal:"OVERWEIGHT",score:70,
   reasons:[{f:"ETF ìŠ¹ì¸â†’ê¸°ê´€ ìê¸ˆ ìœ ì…",i:"+",s:3,n:"BlackRockÂ·Fidelity BTC ETF"},{f:"ë°˜ê°ê¸° ì‚¬ì´í´(2024.4)",i:"+",s:3,n:"ë°˜ê°ê¸° í›„ 12~18ê°œì›” ê°•ì„¸"},{f:"ë””ì§€í„¸ ê¸ˆ ë‚´ëŸ¬í‹°ë¸Œ",i:"+",s:2,n:"ë¶„ì‚° ìì‚°ìœ¼ë¡œ ì¸ì • í™•ì‚°"},{f:"ê³ ë³€ë™ì„± ë¦¬ìŠ¤í¬",i:"-",s:2,n:"ë‹¨ê¸° 30~40% ì¡°ì • ê°€ëŠ¥"}],
   hint:"í¬íŠ¸í´ë¦¬ì˜¤ 5~10% í¸ì…. BTC ETF(IBIT) ë˜ëŠ” í˜„ë¬¼. ë¶„í•  ë§¤ìˆ˜."},
  {asset:"ì±„ê¶Œ (US Treasuries)",icon:"ğŸ“‹",color:"#4caf50",signal:"UNDERWEIGHT",score:38,
   reasons:[{f:"ê³ ê¸ˆë¦¬ ì¥ê¸°í™” ë¦¬ìŠ¤í¬",i:"-",s:3,n:"ì¸í”Œë ˆ ì¬ì í™” ì‹œ ì¶”ê°€ ê¸´ì¶•"},{f:"ì¬ì •ì ì í™•ëŒ€",i:"-",s:2,n:"íŠ¸ëŸ¼í”„ ê°ì„¸â†’ê³µê¸‰ ì¦ê°€â†’ê°€ê²©â†“"},{f:"4.52% ìˆ˜ìµë¥  ë§¤ë ¥",i:"+",s:2,n:"ì—­ì‚¬ì  ì ì • ìˆ˜ì¤€"}],
   hint:"ë‹¨ê¸°ì±„(2Y) ì¤‘ì‹¬ ìµœì†Œ í¸ì…. ê¸ˆë¦¬ ì¸í•˜ ì‹œê·¸ë„ ëª…í™•í•´ì§€ë©´ ë“€ë ˆì´ì…˜ ì—°ì¥."},
  {asset:"ì›ìì¬Â·êµ¬ë¦¬ (Commodities)",icon:"â›",color:"#ff7043",signal:"SELECTIVE BUY",score:61,
   reasons:[{f:"AIÂ·EV ì¸í”„ë¼ êµ¬ë¦¬ ìˆ˜ìš”",i:"+",s:3,n:"ë°ì´í„°ì„¼í„°Â·ì „ê¸°ì°¨ ìˆ˜ìš” í­ë°œ"},{f:"ì¤‘êµ­ ê²½ê¸° ë¶€ì–‘ì±…",i:"+",s:2,n:"ì¸í”„ë¼ íˆ¬ì í™•ëŒ€"},{f:"í¬í† ë¥˜ ì¤‘êµ­ ì˜ì¡´ë„",i:"-",s:2,n:"ìˆ˜ì¶œê·œì œ ë¦¬ìŠ¤í¬"}],
   hint:"êµ¬ë¦¬ ETF(CPER) ë˜ëŠ” FCXÂ·SCCO. í¬í† ë¥˜ëŠ” MP Materials(MP) ê´€ì‹¬."},
  {asset:"ë‹¬ëŸ¬ í˜„ê¸ˆ (USDÂ·MMF)",icon:"ğŸ’µ",color:"#00e676",signal:"HOLD",score:52,
   reasons:[{f:"ë‹¬ëŸ¬ ê°•ì„¸ ì‚¬ì´í´",i:"+",s:2,n:"ë¯¸êµ­ ê²½ì œ ì•„ì›ƒí¼í¼"},{f:"4.25% MMF ìˆ˜ìµ",i:"+",s:2,n:"ë‹¨ê¸° ë¬´ìœ„í—˜ ìˆ˜ìµ ë§¤ë ¥"},{f:"ì—°ì¤€ ì¸í•˜ ì‹œ ì•½ì„¸",i:"-",s:2,n:"ì¸í•˜ ê°€ì‹œí™” ì‹œ ë‹¬ëŸ¬ ì•½ì„¸"}],
   hint:"ë‹¨ê¸° ê³ ê¸ˆë¦¬ MMFÂ·CD í™œìš©. ì¸í•˜ ê°€ì‹œí™” ì‹œ í˜„ê¸ˆ ì¶•ì†Œâ†’ìœ„í—˜ìì‚° ì „í™˜."},
];

const GEO_RISKS=[
  {r:"ë¯¸ì¤‘ íŒ¨ê¶Œì „ìŸ",  risk:82,trend:"â†‘",color:"#ff4444",desc:"ë°˜ë„ì²´ ìˆ˜ì¶œê·œì œÂ·ê´€ì„¸ ë³´ë³µÂ·ëŒ€ë§Œ í•´í˜‘ ê¸´ì¥. AI íŒ¨ê¶Œ í•µì‹¬ ë³€ìˆ˜."},
  {r:"ëŸ¬-ìš° ì „ìŸ",    risk:71,trend:"â†’",color:"#ff7043",desc:"ì—ë„ˆì§€Â·ê³¡ë¬¼ ê³µê¸‰ ë¶ˆì•ˆ. ëŸ¬ì‹œì•„ íŒ”ë¼ë“Â·í¬í† ë¥˜ ìˆ˜ì¶œ ì œí•œ ë¦¬ìŠ¤í¬."},
  {r:"ì¤‘ë™ ê¸´ì¥",     risk:65,trend:"â†‘",color:"#f0b429",desc:"ì´ìŠ¤ë¼ì—˜-ì´ë€ ê°ˆë“±Â·í™í•´ ë¬¼ë¥˜ ì°¨ì§ˆÂ·ìœ ê°€ ë¶ˆì•ˆ ìš”ì¸."},
  {r:"ëŒ€ë§Œ í•´í˜‘",     risk:68,trend:"â†‘",color:"#ff4444",desc:"TSMC ë¦¬ìŠ¤í¬. ê¸€ë¡œë²Œ ë°˜ë„ì²´ ê³µê¸‰ë§ì˜ í•µì‹¬. ì „ìŸ ì‹œ ì¶©ê²© ìµœëŒ€."},
  {r:"í•œë°˜ë„",        risk:45,trend:"â†’",color:"#ff9800",desc:"ë¶í•œ ë¯¸ì‚¬ì¼Â·í•µ ìœ„í˜‘. ì§€ì •í•™ í”„ë¦¬ë¯¸ì—„â†’KOSPI ë””ìŠ¤ì¹´ìš´íŠ¸."},
  {r:"íŠ¸ëŸ¼í”„ ê´€ì„¸",   risk:76,trend:"â†‘",color:"#ff1744",desc:"ë³´í¸ê´€ì„¸ 10~60%. ê¸€ë¡œë²Œ ë¬´ì—­ ì¬í¸ ê°€ì†. 2ì°¨ ì¸í”Œë ˆ ë¦¬ìŠ¤í¬."},
];

const MINERALS=[
  {name:"êµ¬ë¦¬ (Copper)", price:4.52,  chg:+0.35,risk:"ë³´í†µ",   color:"#b87333",dom:"ì¹ ë ˆÂ·í˜ë£¨(60%)",uses:"ì „ì„ Â·EVÂ·ë°˜ë„ì²´", note:"AI ë°ì´í„°ì„¼í„° ìˆ˜ìš” ê¸‰ì¦"},
  {name:"ë‹ˆì¼ˆ (Nickel)", price:16420, chg:-1.20,risk:"ë†’ìŒ",   color:"#888888",dom:"ì¸ë„ë„¤ì‹œì•„(55%)",uses:"ë°°í„°ë¦¬Â·ìŠ¤í…Œì¸ë¦¬ìŠ¤",note:"ì¸ë‹ˆ ìˆ˜ì¶œê·œì œ ì˜í–¥ ì§€ì†"},
  {name:"ë¦¬íŠ¬ (Lithium)",price:12.4,  chg:-2.10,risk:"ë‚®ìŒ",   color:"#64b5f6",dom:"ì¹ ë ˆÂ·í˜¸ì£¼Â·ì¤‘êµ­",uses:"EV ë°°í„°ë¦¬",       note:"ê³µê¸‰ê³¼ì‰â†’ê°€ê²© ì•½ì„¸"},
  {name:"í¬í† ë¥˜ (REE)",  price:null,  chg:null,  risk:"ë§¤ìš°ë†’ìŒ",color:"#ce93d8",dom:"ì¤‘êµ­(85%)",   uses:"ë°˜ë„ì²´Â·ë¬´ê¸°Â·EVëª¨í„°",note:"ì¤‘êµ­ ìˆ˜ì¶œê·œì œ ë¦¬ìŠ¤í¬ â˜…â˜…â˜…"},
  {name:"íŒ”ë¼ë“ (PD)",   price:958,   chg:+1.20, risk:"ë†’ìŒ",   color:"#90caf9",dom:"ëŸ¬ì‹œì•„(45%)", uses:"ìë™ì°¨ ì´‰ë§¤",     note:"ìš°í¬ë¼ì´ë‚˜ ì „ìŸ ê³µê¸‰ ì°¨ì§ˆ"},
  {name:"ì½”ë°œíŠ¸ (Co)",   price:25.8,  chg:-0.40, risk:"ë†’ìŒ",   color:"#4fc3f7",dom:"ì½©ê³ (65%)",   uses:"ë°°í„°ë¦¬Â·í•­ê³µê¸°",   note:"ì •ì¹˜ë¶ˆì•ˆ ê³µê¸‰ ë¦¬ìŠ¤í¬"},
];

function ScoreGauge({score,size=52}){
  const s=score/100,col=s>0.65?C.green:s>0.45?C.gold:C.red;
  const r=size/2-4,circ=2*Math.PI*r,dash=s*circ;
  return(<svg width={size} height={size}><circle cx={size/2} cy={size/2} r={r} fill="none" stroke={C.border} strokeWidth="4"/><circle cx={size/2} cy={size/2} r={r} fill="none" stroke={col} strokeWidth="4" strokeDasharray={`${dash} ${circ}`} strokeDashoffset={circ/4} strokeLinecap="round"/><text x={size/2} y={size/2+4} textAnchor="middle" fill={col} fontSize="12" fontWeight="700" fontFamily="JetBrains Mono,monospace">{score}</text></svg>);
}

function MacroRegimeEngine(){
  const pmi=REGIME_INDICATORS.find(r=>r.key==="pmi"),yc=REGIME_INDICATORS.find(r=>r.key==="yield_curve"),geo=REGIME_INDICATORS.find(r=>r.key==="geopol"),dxy=REGIME_INDICATORS.find(r=>r.key==="dxy");
  const regimes=[];
  if(pmi.value>50)regimes.push({name:"ë¦¬ìŠ¤í¬ì˜¨",icon:"ğŸš€",color:C.green});
  if(yc.value<0)regimes.push({name:"ì¹¨ì²´ ê²½ë³´",icon:"âš ï¸",color:C.red});
  if(geo.value>60)regimes.push({name:"ì§€ì •í•™ ê³ ìœ„í—˜",icon:"ğŸŒ",color:C.orange});
  if(dxy.value>100)regimes.push({name:"ë‹¬ëŸ¬ ê°•ì„¸",icon:"ğŸ’µ",color:C.accent});
  const primary=regimes[0]||{name:"ë³µí•© êµ­ë©´",icon:"ğŸ“Š",color:C.gold};
  return(
    <div style={{background:C.panel,border:`1px solid ${primary.color}44`,borderRadius:8,overflow:"hidden"}}>
      <div style={{padding:"10px 16px",borderBottom:`1px solid ${C.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"}}>
        <div style={{display:"flex",alignItems:"center",gap:10}}>
          <div style={{width:3,height:22,background:primary.color,borderRadius:2}}/>
          <span style={{fontFamily:"Space Grotesk",fontSize:14,fontWeight:700,color:primary.color,letterSpacing:"0.06em"}}>MACRO REGIME ENGINE</span>
          <span style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono"}}>í˜„ì¬ ê¸€ë¡œë²Œ ë§¤í¬ë¡œ êµ­ë©´ ìë™ íŒë³„</span>
        </div>
        <div style={{display:"flex",gap:6}}>
          {regimes.map((r,i)=><span key={i} style={{fontSize:9,color:r.color,background:r.color+"22",padding:"3px 10px",borderRadius:12,fontFamily:"JetBrains Mono",fontWeight:700,border:`1px solid ${r.color}55`}}>{r.icon} {r.name}</span>)}
        </div>
      </div>
      <div style={{padding:"12px 16px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:14}}>
        <div>
          <div style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono",fontWeight:700,marginBottom:8,letterSpacing:"0.1em"}}>í•µì‹¬ ë§¤í¬ë¡œ ì§€í‘œ</div>
          <div style={{display:"flex",flexDirection:"column",gap:5}}>
            {REGIME_INDICATORS.map(ind=>{
              const good=ind.bad?(ind.value<ind.threshold):(ind.value>ind.threshold);
              const pct=Math.min(Math.abs(ind.value/(ind.threshold||1))*50+30,95);
              return(<div key={ind.key} style={{display:"flex",alignItems:"center",gap:8,padding:"5px 8px",background:C.bg,borderRadius:4}}>
                <div style={{minWidth:140,fontSize:9,color:C.text,fontFamily:"JetBrains Mono"}}>{ind.name}</div>
                <div style={{flex:1,height:4,background:C.border,borderRadius:2}}><div style={{width:`${pct}%`,height:"100%",background:good?C.green:C.red,borderRadius:2}}/></div>
                <div style={{minWidth:72,fontSize:9,fontWeight:700,color:good?C.green:C.red,fontFamily:"JetBrains Mono",textAlign:"right"}}>{ind.value}{ind.unit}</div>
                <div style={{minWidth:88,fontSize:8,color:C.muted,fontFamily:"JetBrains Mono"}}>{ind.signal}</div>
              </div>);
            })}
          </div>
        </div>
        <div>
          <div style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono",fontWeight:700,marginBottom:8,letterSpacing:"0.1em"}}>í˜„ì¬ êµ­ë©´ â†’ ì „ëµì  ìì‚°ë°°ë¶„ ì œì•ˆ</div>
          <div style={{background:C.bg,borderRadius:6,padding:"10px 12px",border:`1px solid ${primary.color}33`,marginBottom:10}}>
            <div style={{fontSize:11,color:primary.color,fontWeight:700,fontFamily:"Space Grotesk",marginBottom:4}}>{primary.icon} {primary.name}</div>
            <div style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono",lineHeight:1.7}}>
              <span style={{color:C.accent}}>ìˆ˜ìµë¥ ê³¡ì„  ì—­ì „(-0.34%p)</span> + <span style={{color:C.gold}}>ì§€ì •í•™ ê³ ì¡°(72/100)</span> + <span style={{color:C.green}}>AIë¶</span> ê³µì¡´ ë³µí•© êµ­ë©´.<br/>
              ë‹¬ëŸ¬ ê°•ì„¸â†’ì‹ í¥êµ­ ì´íƒˆ, ê¸ˆÂ·BTC ë™ë°˜ ê°•ì„¸, AI ì¸í”„ë¼ê°€ í•µì‹¬ ë“œë¼ì´ë²„.
            </div>
          </div>
          {[{label:"ë¯¸êµ­ ì£¼ì‹ (AIÂ·ê¸°ìˆ )",pct:30,col:C.accent},{label:"ê¸ˆ (Gold)",pct:15,col:"#ffd700"},{label:"ë¹„íŠ¸ì½”ì¸ (BTC)",pct:8,col:"#ff6b6b"},{label:"êµ¬ë¦¬Â·ì›ìì¬",pct:8,col:"#ff7043"},{label:"ë‹¨ê¸° ë¯¸êµ­ì±„",pct:22,col:"#4caf50"},{label:"í•œêµ­ ë°˜ë„ì²´",pct:10,col:"#ff9800"},{label:"MMF (í˜„ê¸ˆ)",pct:7,col:C.green}].map(a=>(
            <div key={a.label} style={{display:"flex",alignItems:"center",gap:8,marginBottom:5}}>
              <div style={{fontSize:9,color:a.col,fontFamily:"JetBrains Mono",minWidth:155}}>{a.label}</div>
              <div style={{flex:1,height:14,background:C.border,borderRadius:3,overflow:"hidden"}}>
                <div style={{width:`${a.pct/30*100}%`,height:"100%",background:a.col+"66",borderRadius:3,display:"flex",alignItems:"center",paddingLeft:4}}>
                  <span style={{fontSize:8,color:a.col,fontWeight:700,fontFamily:"JetBrains Mono"}}>{a.pct}%</span>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}

function ActionSignalEngine(){
  const [sel,setSel]=useState(0);const sig=SIGNALS[sel];
  const sigColors={"OVERWEIGHT":C.green,"NEUTRALâ†’BUY":C.gold,"HOLD":C.gold,"UNDERWEIGHT":C.red,"SELECTIVE BUY":C.orange};
  const sc=sigColors[sig.signal]||C.accent;
  return(
    <div style={{background:C.panel,border:`1px solid ${C.border}`,borderRadius:8,overflow:"hidden"}}>
      <div style={{padding:"8px 16px",borderBottom:`1px solid ${C.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"}}>
        <div style={{display:"flex",alignItems:"center",gap:8}}>
          <div style={{width:3,height:18,background:C.gold,borderRadius:2}}/>
          <span style={{fontFamily:"Space Grotesk",fontSize:12,fontWeight:700,color:C.gold,letterSpacing:"0.08em"}}>â˜… ACTION SIGNAL ENGINE</span>
          <span style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono"}}>ìì‚°ë³„ ë§¤í¬ë¡œ ì‹œê·¸ë„ & í–‰ë™ ì§€ì¹¨</span>
        </div>
        <span style={{fontSize:8,color:C.dim,fontFamily:"JetBrains Mono"}}>ì¶”ì • ë°ì´í„° Â· íˆ¬ì ì°¸ê³ ìš© only</span>
      </div>
      <div style={{display:"flex",height:300}}>
        <div style={{width:190,borderRight:`1px solid ${C.border}`,overflowY:"auto"}}>
          {SIGNALS.map((s,i)=>{const c=sigColors[s.signal]||C.accent;return(
            <div key={i} onClick={()=>setSel(i)} style={{padding:"10px 12px",cursor:"pointer",borderBottom:`1px solid ${C.border}`,background:i===sel?c+"11":C.bg,borderLeft:i===sel?`3px solid ${c}`:"3px solid transparent"}}>
              <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:3}}>
                <span style={{fontSize:11}}>{s.icon}</span>
                <span style={{fontSize:7,color:c,fontWeight:700,fontFamily:"JetBrains Mono",padding:"1px 5px",background:c+"22",borderRadius:3}}>{s.signal}</span>
              </div>
              <div style={{fontSize:9,color:i===sel?c:C.text,fontFamily:"JetBrains Mono",fontWeight:i===sel?700:400,lineHeight:1.4}}>{s.asset}</div>
              <div style={{marginTop:4,height:2,background:C.border,borderRadius:1}}><div style={{width:`${s.score}%`,height:"100%",background:c,borderRadius:1}}/></div>
            </div>
          );})}
        </div>
        <div style={{flex:1,padding:"14px 18px",overflowY:"auto"}}>
          <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12}}>
            <div>
              <div style={{fontSize:14,color:sig.color,fontWeight:700,fontFamily:"Space Grotesk",marginBottom:2}}>{sig.icon} {sig.asset}</div>
              <div style={{fontSize:20,color:sc,fontWeight:700,fontFamily:"JetBrains Mono",textShadow:`0 0 10px ${sc}66`}}>{sig.signal}</div>
            </div>
            <ScoreGauge score={sig.score} size={60}/>
          </div>
          <div style={{marginBottom:12}}>
            <div style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono",fontWeight:700,marginBottom:6,letterSpacing:"0.1em"}}>SIGNAL FACTORS</div>
            {sig.reasons.map((r,i)=>(
              <div key={i} style={{display:"flex",alignItems:"center",gap:8,marginBottom:5,padding:"5px 8px",background:C.bg,borderRadius:4,border:`1px solid ${r.i==="+"?C.green+"33":C.red+"33"}`}}>
                <span style={{fontSize:11,color:r.i==="+"?C.green:C.red,fontWeight:700,minWidth:14}}>{r.i==="+"?"â–²":"â–¼"}</span>
                <div style={{flex:1}}>
                  <div style={{fontSize:9,color:r.i==="+"?C.green:C.red,fontFamily:"JetBrains Mono",fontWeight:700}}>{r.f}</div>
                  <div style={{fontSize:8,color:C.dim,fontFamily:"JetBrains Mono"}}>{r.n}</div>
                </div>
                <div style={{display:"flex",gap:2}}>{Array.from({length:3},(_,j)=><div key={j} style={{width:6,height:6,borderRadius:"50%",background:j<r.s?(r.i==="+"?C.green:C.red):C.border}}/>)}</div>
              </div>
            ))}
          </div>
          <div style={{background:sc+"11",border:`1px solid ${sc}44`,borderRadius:5,padding:"8px 12px"}}>
            <div style={{fontSize:9,color:sc,fontFamily:"JetBrains Mono",fontWeight:700,marginBottom:3}}>âš¡ í–‰ë™ ì§€ì¹¨</div>
            <div style={{fontSize:9,color:C.text,fontFamily:"JetBrains Mono",lineHeight:1.7}}>{sig.hint}</div>
          </div>
        </div>
      </div>
    </div>
  );
}

function CountryHealthDashboard(){
  const [sel,setSel]=useState("us");const country=COUNTRIES.find(c=>c.id===sel)||COUNTRIES[0];
  function health(c){
    let s=50;if(c.gdpGrowth>2)s+=12;else if(c.gdpGrowth>0)s+=5;else s-=10;
    if(c.cpi<2.5&&c.cpi>0.5)s+=12;else if(c.cpi<4)s+=4;else s-=10;
    if(c.unemployment<4)s+=12;else if(c.unemployment<6)s+=6;else s-=8;
    if(c.pmi>52)s+=10;else if(c.pmi>50)s+=5;else s-=5;
    if(c.currentAccount>0)s+=8;else s-=4;if(c.debtGDP<60)s+=6;else if(c.debtGDP>150)s-=8;
    return Math.max(10,Math.min(95,s));
  }
  const terms=["1M","3M","6M","1Y","2Y","5Y","10Y","30Y"];
  return(
    <div style={{background:C.panel,border:`1px solid ${C.border}`,borderRadius:8,overflow:"hidden"}}>
      <div style={{padding:"8px 16px",borderBottom:`1px solid ${C.border}`,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:6}}>
        <div style={{display:"flex",alignItems:"center",gap:8}}>
          <div style={{width:3,height:18,background:C.purple,borderRadius:2}}/>
          <span style={{fontFamily:"Space Grotesk",fontSize:12,fontWeight:700,color:C.purple,letterSpacing:"0.08em"}}>êµ­ê°€ë³„ ê²½ì œ ê±´ê°•ë„ Â· COUNTRY MACRO HEALTH</span>
        </div>
        <div style={{display:"flex",gap:4,flexWrap:"wrap"}}>
          {COUNTRIES.map(c=><button key={c.id} onClick={()=>setSel(c.id)} className={`btn${sel===c.id?" active":""}`} style={{padding:"3px 7px",fontSize:9,color:sel===c.id?c.color:C.muted,borderColor:sel===c.id?c.color:C.border}}>{c.flag} {c.name}</button>)}
        </div>
      </div>
      <div style={{padding:"12px 16px",display:"grid",gridTemplateColumns:"210px 1fr 1fr",gap:12}}>
        <div>
          <div style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono",fontWeight:700,marginBottom:8,letterSpacing:"0.1em"}}>ê±´ê°•ë„ ë­í‚¹</div>
          {[...COUNTRIES].sort((a,b)=>health(b)-health(a)).map((c,i)=>{const sc=health(c);const col=sc>65?C.green:sc>50?C.gold:C.red;return(
            <div key={c.id} onClick={()=>setSel(c.id)} style={{display:"flex",alignItems:"center",gap:7,padding:"6px 8px",background:sel===c.id?c.color+"11":C.bg,borderRadius:5,marginBottom:4,cursor:"pointer",border:`1px solid ${sel===c.id?c.color:C.border}`}}>
              <span style={{fontSize:8,color:C.dim,minWidth:12}}>{i+1}</span>
              <span style={{fontSize:12}}>{c.flag}</span>
              <span style={{fontSize:9,color:C.text,fontFamily:"JetBrains Mono",flex:1}}>{c.name}</span>
              <ScoreGauge score={sc} size={34}/>
            </div>
          );})}
        </div>
        <div>
          <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:10}}>
            <span style={{fontSize:22}}>{country.flag}</span>
            <div><div style={{fontSize:14,color:country.color,fontWeight:700,fontFamily:"Space Grotesk"}}>{country.name}</div>
            <div style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono"}}>{country.cbName} ê¸°ì¤€ê¸ˆë¦¬ {country.policyRate}%</div></div>
          </div>
          {[{l:"GDP ì„±ì¥ë¥ ",v:`${country.gdpGrowth}%`,g:country.gdpGrowth>1.5,ic:"ğŸ“ˆ"},{l:"ì†Œë¹„ìë¬¼ê°€(CPI)",v:`${country.cpi}%`,g:country.cpi<3&&country.cpi>0.5,ic:"ğŸ’°"},{l:"ì‹¤ì—…ë¥ ",v:`${country.unemployment}%`,g:country.unemployment<5,ic:"ğŸ‘¥"},{l:"PMI(ì œì¡°ì—…)",v:`${country.pmi}`,g:country.pmi>50,ic:"ğŸ­"},{l:"ê²½ìƒìˆ˜ì§€/GDP",v:`${country.currentAccount}%`,g:country.currentAccount>0,ic:"âš–ï¸"},{l:"êµ­ê°€ë¶€ì±„/GDP",v:`${country.debtGDP}%`,g:country.debtGDP<80,ic:"ğŸ¦"},{l:"ê¸°ì¤€ê¸ˆë¦¬",v:`${country.policyRate}%`,g:true,ic:"ğŸ›ï¸"},{l:"10Y ì‹œì¥ê¸ˆë¦¬",v:`${country.mktRate10y}%`,g:true,ic:"ğŸ“‹"}].map(item=>(
            <div key={item.l} style={{display:"flex",alignItems:"center",gap:8,padding:"5px 8px",background:C.bg,borderRadius:4,marginBottom:3}}>
              <span style={{fontSize:11}}>{item.ic}</span>
              <span style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono",flex:1}}>{item.l}</span>
              <span style={{fontSize:11,fontWeight:700,color:item.g?C.green:C.red,fontFamily:"JetBrains Mono"}}>{item.v}</span>
            </div>
          ))}
          <div style={{marginTop:8,padding:"8px 10px",background:country.color+"11",borderRadius:5,border:`1px solid ${country.color}44`}}>
            <div style={{fontSize:8,color:C.muted,fontFamily:"JetBrains Mono",marginBottom:2}}>ë‹¤ìŒ ì¤‘ì•™ì€í–‰ íšŒì˜</div>
            <div style={{fontSize:10,color:country.color,fontFamily:"JetBrains Mono",fontWeight:700}}>{country.nextMeeting}</div>
            <div style={{fontSize:9,color:C.text,fontFamily:"JetBrains Mono",marginTop:2}}>ì˜ˆìƒ: <span style={{color:country.stanceDir>0?C.green:country.stanceDir<0?C.red:C.gold,fontWeight:700}}>{country.stance}</span></div>
          </div>
        </div>
        <div>
          <div style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono",fontWeight:700,marginBottom:8,letterSpacing:"0.1em"}}>ìˆ˜ìµë¥ ê³¡ì„  (YIELD CURVE) Â· {country.name}</div>
          {country.yields&&(()=>{
            const mn=Math.min(...country.yields)-0.2,mx=Math.max(...country.yields)+0.2,rng=mx-mn;const W=240,H=100;
            const pts=country.yields.map((v,i)=>`${(i/(country.yields.length-1))*W},${H-((v-mn)/rng)*(H-16)-8}`).join(" ");
            const spread=+(country.yields[5]-country.yields[2]).toFixed(2);const inv=spread<0;
            return(<div style={{background:C.bg,borderRadius:5,padding:"8px 10px",border:`1px solid ${inv?C.red+"66":C.border}`}}>
              <svg width={W} height={H} style={{display:"block"}}>
                {[0,0.25,0.5,0.75,1].map(r=>{const y=H-r*(H-16)-8,v=(mn+r*rng).toFixed(2);return(<g key={r}><line x1="0" y1={y} x2={W} y2={y} stroke={C.border} strokeWidth="0.5" strokeDasharray="3 4"/><text x="2" y={y-2} fill={C.dim} fontSize="7" fontFamily="JetBrains Mono">{v}%</text></g>);})}
                <polyline points={pts} fill="none" stroke={inv?C.red:C.green} strokeWidth="2" strokeLinejoin="round"/>
                {country.yields.map((v,i)=>{const x=(i/(country.yields.length-1))*W,y=H-((v-mn)/rng)*(H-16)-8;return(<g key={i}><circle cx={x} cy={y} r="3" fill={inv?C.red:C.green}/><text x={x} y={y-5} textAnchor="middle" fill={inv?C.red:C.green} fontSize="7" fontFamily="JetBrains Mono">{v.toFixed(2)}</text></g>);})}
              </svg>
              <div style={{display:"flex",justifyContent:"space-between",marginTop:2}}>{terms.map(t=><span key={t} style={{fontSize:7,color:C.dim,fontFamily:"JetBrains Mono"}}>{t}</span>)}</div>
              <div style={{marginTop:6,padding:"4px 8px",background:inv?C.red+"11":C.green+"11",borderRadius:3,border:`1px solid ${inv?C.red+"44":C.green+"44"}`}}>
                <span style={{fontSize:9,color:inv?C.red:C.green,fontFamily:"JetBrains Mono",fontWeight:700}}>{inv?`âš ï¸ ì—­ì „ (${spread}%p) â†’ ì¹¨ì²´ ì„ í–‰ ì‹ í˜¸`:`âœ… ì •ìƒ (${spread}%p)`}</span>
              </div>
            </div>);
          })()}
          <div style={{marginTop:8}}>
            <div style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono",fontWeight:700,marginBottom:6}}>ë¯¸êµ­(US 10Y 4.52%) ëŒ€ë¹„ ê¸ˆë¦¬ì°¨</div>
            {COUNTRIES.filter(c=>c.id!=="us").map(c=>{const diff=+(4.52-c.mktRate10y).toFixed(2);const w=Math.min(Math.abs(diff)/5*100,100);return(
              <div key={c.id} style={{display:"flex",alignItems:"center",gap:5,marginBottom:3}}>
                <span style={{fontSize:9}}>{c.flag}</span>
                <span style={{fontSize:8,color:C.muted,fontFamily:"JetBrains Mono",minWidth:40}}>{c.name}</span>
                <div style={{flex:1,height:7,background:C.border,borderRadius:3,overflow:"hidden"}}><div style={{width:`${w}%`,height:"100%",background:diff>0?C.accent:C.red,borderRadius:3}}/></div>
                <span style={{fontSize:9,color:diff>0?C.accent:C.red,fontFamily:"JetBrains Mono",fontWeight:700,minWidth:38,textAlign:"right"}}>{diff>0?"+":""}{diff}%p</span>
              </div>
            );})}
          </div>
        </div>
      </div>
    </div>
  );
}

function GeopoliticalRiskPanel(){
  return(
    <div style={{background:C.panel,border:`1px solid ${C.border}`,borderRadius:8,overflow:"hidden"}}>
      <div style={{padding:"8px 16px",borderBottom:`1px solid ${C.border}`,display:"flex",alignItems:"center",gap:8}}>
        <div style={{width:3,height:18,background:C.red,borderRadius:2}}/>
        <span style={{fontFamily:"Space Grotesk",fontSize:12,fontWeight:700,color:C.red,letterSpacing:"0.08em"}}>ì§€ì •í•™ ë¦¬ìŠ¤í¬ ë ˆì´ë” Â· GEOPOLITICAL RISK</span>
      </div>
      <div style={{padding:"12px 16px",display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:8}}>
        {GEO_RISKS.map(r=>{const col=r.risk>70?C.red:r.risk>50?C.orange:C.gold;return(
          <div key={r.r} style={{background:C.bg,borderRadius:6,padding:"10px 12px",border:`1px solid ${col}44`}}>
            <div style={{display:"flex",justifyContent:"space-between",marginBottom:7}}>
              <span style={{fontSize:10,color:col,fontFamily:"JetBrains Mono",fontWeight:700}}>{r.r}</span>
              <span style={{fontSize:12,color:col}}>{r.trend}</span>
            </div>
            <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:6}}>
              <div style={{flex:1,height:5,background:C.border,borderRadius:2,overflow:"hidden"}}><div style={{width:`${r.risk}%`,height:"100%",background:col,borderRadius:2}}/></div>
              <span style={{fontSize:13,color:col,fontWeight:700,fontFamily:"JetBrains Mono"}}>{r.risk}</span>
            </div>
            <div style={{fontSize:8,color:C.muted,fontFamily:"JetBrains Mono",lineHeight:1.6}}>{r.desc}</div>
          </div>
        );})}
      </div>
    </div>
  );
}

function CriticalMineralsTracker(){
  const riskCols={"ë‚®ìŒ":C.green,"ë³´í†µ":C.gold,"ë†’ìŒ":C.orange,"ë§¤ìš°ë†’ìŒ":C.red};
  return(
    <div style={{background:C.panel,border:`1px solid ${C.border}`,borderRadius:8,overflow:"hidden"}}>
      <div style={{padding:"8px 16px",borderBottom:`1px solid ${C.border}`,display:"flex",alignItems:"center",gap:8}}>
        <div style={{width:3,height:18,background:C.orange,borderRadius:2}}/>
        <span style={{fontFamily:"Space Grotesk",fontSize:12,fontWeight:700,color:C.orange,letterSpacing:"0.08em"}}>í•µì‹¬ ê´‘ë¬¼ ê³µê¸‰ë§ Â· CRITICAL MINERALS</span>
        <span style={{fontSize:9,color:C.muted,fontFamily:"JetBrains Mono"}}>AIÂ·EVÂ·ë°©ì‚°ì˜ í•µì‹¬ ì›ë£Œ ì¶”ì </span>
      </div>
      <div style={{padding:"12px 16px",display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:8}}>
        {MINERALS.map(m=>{const rc=riskCols[m.risk]||C.gold;return(
          <div key={m.name} style={{background:C.bg,borderRadius:6,padding:"10px 12px",border:`1px solid ${m.color}44`}}>
            <div style={{display:"flex",justifyContent:"space-between",marginBottom:6}}>
              <span style={{fontSize:10,color:m.color,fontFamily:"JetBrains Mono",fontWeight:700}}>{m.name}</span>
              <span style={{fontSize:8,color:rc,background:rc+"22",padding:"1px 6px",borderRadius:3,fontFamily:"JetBrains Mono",fontWeight:700}}>ë¦¬ìŠ¤í¬ {m.risk}</span>
            </div>
            {m.price&&<div style={{fontSize:14,color:m.color,fontWeight:700,fontFamily:"JetBrains Mono",marginBottom:3}}>{m.price}{m.chg!=null&&<span style={{fontSize:9,color:m.chg>=0?C.green:C.red,marginLeft:6}}>{m.chg>=0?"â–²":"â–¼"}{Math.abs(m.chg)}%</span>}</div>}
            <div style={{fontSize:8,color:C.muted,fontFamily:"JetBrains Mono",marginBottom:2}}>ìƒì‚°êµ­: <span style={{color:C.text}}>{m.dom}</span></div>
            <div style={{fontSize:8,color:C.muted,fontFamily:"JetBrains Mono",marginBottom:2}}>ìš©ë„: <span style={{color:C.accent}}>{m.uses}</span></div>
            <div style={{fontSize:8,color:C.gold,fontFamily:"JetBrains Mono",fontStyle:"italic"}}>{m.note}</div>
          </div>
        );})}
      </div>
    </div>
  );
}

function App(){
  const [clock,setClock]=useState(new Date());
  useEffect(()=>{const iv=setInterval(()=>setClock(new Date()),1000);return()=>clearInterval(iv);},[]);
  const kst=new Date(clock.toLocaleString("en-US",{timeZone:"Asia/Seoul"}));
  const nyc=new Date(clock.toLocaleString("en-US",{timeZone:"America/New_York"}));
  const lon=new Date(clock.toLocaleString("en-US",{timeZone:"Europe/London"}));
  const nyOpen=nyc.getHours()>=9&&nyc.getHours()<16;
  const lonOpen=lon.getHours()>=8&&lon.getHours()<16;
  const kstMkt=(kst.getHours()>=9&&kst.getHours()<15);

  return(
    <div style={{background:C.bg,minHeight:"100vh",fontFamily:"'JetBrains Mono','Courier New',monospace",color:C.text}}>

      {/* í—¤ë” */}
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 16px",height:46,background:"#040608",borderBottom:`1px solid ${C.border}`}}>
        <div style={{display:"flex",alignItems:"center",gap:12}}>
          <div style={{width:3,height:24,background:C.accent,borderRadius:2}}/>
          <span style={{fontFamily:"Space Grotesk",fontSize:17,fontWeight:700,color:C.accent,letterSpacing:"0.05em"}}>MACRO TERMINAL</span>
          <span style={{fontSize:9,color:C.muted,background:C.panel,padding:"2px 8px",borderRadius:10,border:`1px solid ${C.border}`}}>v4.0 Â· GLOBAL MARKETS</span>
        </div>
        <div style={{display:"flex",gap:18,fontSize:10,alignItems:"center"}}>
          <span style={{color:C.muted}}>KST <span style={{color:kstMkt?C.green:C.accent}}>{kst.toLocaleTimeString("ko-KR",{hour12:false})}</span> {kstMkt&&<span style={{color:C.green,fontSize:8}}>OPEN</span>}</span>
          <span style={{color:C.muted}}>LON <span style={{color:lonOpen?C.green:C.gold}}>{lon.toLocaleTimeString("en-GB",{hour12:false})}</span> {lonOpen&&<span style={{color:C.green,fontSize:8}}>OPEN</span>}</span>
          <span style={{color:C.muted}}>NYC <span style={{color:nyOpen?C.green:C.gold}}>{nyc.toLocaleTimeString("en-US",{hour12:false})}</span></span>
          <span style={{color:nyOpen?C.green:C.red,fontSize:9,padding:"2px 8px",border:`1px solid ${(nyOpen?C.green:C.red)}55`,borderRadius:3}}>â— NYSE {nyOpen?"OPEN":"CLOSED"}</span>
        </div>
      </div>

      {/* í‹°ì»¤ */}
      <div style={{borderBottom:`1px solid ${C.border}`,height:46,overflow:"hidden"}}>
        <TV type="ticker-tape" height={46} opts={{
          symbols:[
            {proName:"FOREXCOM:SPXUSD",title:"S&P 500"},{proName:"FOREXCOM:NSXUSD",title:"NASDAQ 100"},
            {proName:"DJ:DJI",title:"DOW JONES"},{proName:"KRX:KOSPI",title:"KOSPI"},{proName:"KRX:KOSDAQ",title:"KOSDAQ"},
            {proName:"INDEX:NKY",title:"NIKKEI 225"},{proName:"INDEX:DEU40",title:"DAX"},{proName:"INDEX:HSI",title:"í•­ì…"},
            {proName:"SSE:000001",title:"ìƒí•˜ì´"},{proName:"BITSTAMP:BTCUSD",title:"BTC/USD"},
            {proName:"BITSTAMP:ETHUSD",title:"ETH/USD"},{proName:"FOREXCOM:USDKRW",title:"USD/KRW"},
            {proName:"FOREXCOM:USDJPY",title:"USD/JPY"},{proName:"COMEX:GC1!",title:"ê¸ˆ ì„ ë¬¼"},{proName:"NYMEX:CL1!",title:"WTI ì›ìœ "},
          ],
          showSymbolLogo:false,displayMode:"adaptive",
        }}/>
      </div>

      <div style={{padding:"10px 12px",display:"flex",flexDirection:"column",gap:10}}>

        {/* â˜… ìê¸ˆ íë¦„ íˆì–´ë¡œ */}
        <CapitalFlowHero/>

        {/* ê¸€ë¡œë²Œ ì¦ì‹œ - ë†’ì´ ëŠ˜ë¦¼ */}
        <Box title="ê¸€ë¡œë²Œ ì¦ì‹œ Â· Global Indices" badge={<span style={{fontSize:9,color:C.green}}>â— TRADINGVIEW REAL-TIME</span>}>
          <TV type="market-overview" height={280} opts={{
            dateRange:"1D",showChart:true,
            plotLineColorGrowing:"rgba(0,212,255,1)",plotLineColorFalling:"rgba(255,23,68,1)",
            gridLineColor:"rgba(28,35,51,1)",scaleFontColor:"rgba(90,106,122,1)",
            belowLineFillColorGrowing:"rgba(0,212,255,0.12)",belowLineFillColorFalling:"rgba(255,23,68,0.12)",
            showFloatingTooltip:true,showSymbolLogo:true,
            tabs:[
              {title:"ì£¼ìš” ì§€ìˆ˜",symbols:[
                {s:"FOREXCOM:SPXUSD",d:"S&P 500"},{s:"FOREXCOM:NSXUSD",d:"NASDAQ 100"},{s:"DJ:DJI",d:"DOW JONES"},
                {s:"KRX:KOSPI",d:"KOSPI"},{s:"KRX:KOSDAQ",d:"KOSDAQ"},{s:"INDEX:NKY",d:"NIKKEI 225"},
                {s:"INDEX:DEU40",d:"DAX"},{s:"INDEX:HSI",d:"í•­ì…"},{s:"SSE:000001",d:"ìƒí•˜ì´"},
              ]},
              {title:"ì•„ì‹œì•„",symbols:[
                {s:"KRX:KOSPI",d:"KOSPI"},{s:"KRX:KOSDAQ",d:"KOSDAQ"},{s:"INDEX:NKY",d:"NIKKEI"},
                {s:"INDEX:HSI",d:"í•­ì…"},{s:"SSE:000001",d:"ìƒí•˜ì´ ì¢…í•©"},{s:"SSE:000300",d:"CSI 300"},
                {s:"NSE:NIFTY50",d:"NIFTY 50"},{s:"ASX:XJO",d:"ASX 200"},{s:"MYX:FBMKLCI",d:"KLCI(ë§ë ˆì´)"},
                {s:"SET:SET",d:"SET(íƒœêµ­)"},{s:"IDX:COMPOSITE",d:"JCI(ì¸ë„ë„¤ì‹œì•„)"},
              ]},
              {title:"ìœ ëŸ½",symbols:[
                {s:"INDEX:DEU40",d:"DAX"},{s:"INDEX:UKX",d:"FTSE 100"},{s:"INDEX:CAC40",d:"CAC 40"},
                {s:"INDEX:SMI",d:"SMI(ìŠ¤ìœ„ìŠ¤)"},{s:"INDEX:AEX",d:"AEX(ë„¤ëœë€ë“œ)"},{s:"INDEX:IBEX35",d:"IBEX35(ìŠ¤í˜ì¸)"},
                {s:"INDEX:FTSEMIB",d:"FTSE MIB(ì´íƒˆë¦¬ì•„)"},
              ]},
              {title:"ë¯¸ì£¼",symbols:[
                {s:"FOREXCOM:SPXUSD",d:"S&P 500"},{s:"FOREXCOM:NSXUSD",d:"NASDAQ 100"},
                {s:"DJ:DJI",d:"DOW"},{s:"NASDAQ:IWM",d:"Russell 2000"},
                {s:"BMFBOVESPA:IBOV",d:"BOVESPA(ë¸Œë¼ì§ˆ)"},{s:"BMV:IPC",d:"IPC(ë©•ì‹œì½”)"},
                {s:"BCBA:IMV",d:"MERVAL(ì•„ë¥´í—¨í‹°ë‚˜)"},
              ]},
              {title:"í•œêµ­ ì„¸ë¶€",symbols:[
                {s:"KRX:KOSPI",d:"KOSPI"},{s:"KRX:KOSDAQ",d:"KOSDAQ"},
                {s:"KRX:005930",d:"ì‚¼ì„±ì „ì"},{s:"KRX:000660",d:"SKí•˜ì´ë‹‰ìŠ¤"},
                {s:"KRX:035420",d:"NAVER"},{s:"KRX:035720",d:"ì¹´ì¹´ì˜¤"},
                {s:"KRX:051910",d:"LGí™”í•™"},{s:"KRX:006400",d:"ì‚¼ì„±SDI"},
                {s:"KRX:028260",d:"ì‚¼ì„±ë¬¼ì‚°"},{s:"KRX:086520",d:"ì—ì½”í”„ë¡œ"},
              ]},
            ],
          }}/>
        </Box>

        {/* ìì‚° ìƒê´€ê´€ê³„ + ì„¹í„° íˆíŠ¸ë§µ */}
        <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10}}>
          <CorrelationMatrix/>
          <Box title="S&P 500 ì„¹í„° íˆíŠ¸ë§µ" badge={<span style={{fontSize:9,color:C.green}}>â— LIVE</span>}>
            <TV type="stock-heatmap" height={430} opts={{
              exchanges:[],dataSource:"SPX500",grouping:"sector",
              blockSize:"market_cap_basic",blockColor:"change",
              hasTopBar:false,isDataSetEnabled:false,isZoomEnabled:true,hasSymbolTooltip:true,
            }}/>
          </Box>
        </div>

        {/* ì•„ë¹„íŠ¸ë¼ì§€ */}
        <ArbitragePanel/>

        {/* FX í¬ë¡œìŠ¤ + í™˜ìœ¨ ìŠ¤íŒŒí¬ë¼ì¸ */}
        <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10}}>
          <Box title="í™˜ìœ¨ í¬ë¡œìŠ¤ Â· FX Cross Rates" badge={<span style={{fontSize:9,color:C.green}}>â— TRADINGVIEW LIVE</span>}>
            <TV type="forex-cross-rates" height={260} opts={{
              currencies:["USD","KRW","EUR","JPY","GBP","CNY","AUD","CAD","MXN"],
            }}/>
          </Box>
          <Box title="í™˜ìœ¨ ì¶”ì´ Â· FX with Trend (24M)" badge={<span style={{fontSize:9,color:C.green}}>â— LIVE + 24ê°œì›” ì¶”ì„¸</span>}>
            <FXPanel/>
          </Box>
        </div>

        {/* ì•”í˜¸í™”í + ê¸ˆë¦¬ + ì›ìì¬ */}
        <div style={{display:"grid",gridTemplateColumns:"1fr 200px 1fr",gap:10}}>
          <Box title="ì•”í˜¸í™”í (ì‹¤ì‹œê°„) Â· Crypto"><CryptoLive/></Box>
          <Box title="ê¸ˆë¦¬ Â· Rates">
            <div style={{padding:"8px 10px",display:"flex",flexDirection:"column",gap:4}}>
              {[
                {name:"US Fed",value:4.25,prev:4.50,term:"Policy"},
                {name:"US 2Y",value:4.18,prev:4.22,term:"Short"},
                {name:"US 10Y",value:4.52,prev:4.48,term:"Long"},
                {name:"US 30Y",value:4.73,prev:4.69,term:"Long"},
                {name:"ECB",value:2.65,prev:2.90,term:"Policy"},
                {name:"BOJ",value:0.50,prev:0.25,term:"Policy"},
                {name:"BOK",value:2.75,prev:3.00,term:"Policy"},
              ].map(r=>{
                const down=r.value<r.prev;
                const tc=r.term==="Policy"?C.purple:r.term==="Short"?C.gold:C.green;
                return(
                  <div key={r.name} style={{padding:"4px 8px",background:C.bg,borderRadius:4,border:`1px solid ${C.border}`}}>
                    <div style={{display:"flex",justifyContent:"space-between"}}>
                      <span style={{fontSize:8,color:C.muted}}>{r.name}</span>
                      <span style={{fontSize:7,color:tc}}>{r.term}</span>
                    </div>
                    <div style={{display:"flex",justifyContent:"space-between"}}>
                      <span style={{fontSize:12,fontWeight:700,color:C.text}}>{r.value.toFixed(2)}%</span>
                      <span style={{fontSize:9,color:down?C.green:C.red}}>{down?"â–¼":"â–²"}{Math.abs(r.value-r.prev).toFixed(2)}</span>
                    </div>
                  </div>
                );
              })}
            </div>
          </Box>
          <Box title="ì›ìì¬ Â· Commodities">
            <div style={{padding:"8px 10px",display:"flex",flexDirection:"column",gap:5}}>
              {[
                {s:"XAU/USD",p:3018.4,c:0.82,col:"#ffd700"},{s:"XAG/USD",p:33.24,c:1.14,col:"#c0c0c0"},
                {s:"WTI",p:68.45,c:-0.63,col:"#ff7043"},{s:"Brent",p:72.18,c:-0.41,col:"#ff9800"},
                {s:"NatGas",p:3.82,c:2.15,col:"#4caf50"},{s:"Copper",p:4.52,c:0.35,col:"#b87333"},
              ].map(x=>(
                <div key={x.s} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"5px 8px",background:C.bg,borderRadius:4,border:`1px solid ${C.border}`}}>
                  <span style={{color:x.col,fontSize:9,fontWeight:700,minWidth:52}}>{x.s}</span>
                  <span style={{color:C.text,fontSize:10}}>${x.p.toFixed(2)}</span>
                  <span style={{color:x.c>=0?C.green:C.red,fontSize:9}}>{x.c>=0?"â–²":"â–¼"}{Math.abs(x.c).toFixed(2)}%</span>
                </div>
              ))}
            </div>
          </Box>
        </div>

        {/* ê²½ì œ ìº˜ë¦°ë” */}
        <Box title="ê²½ì œ ìº˜ë¦°ë” Â· Economic Calendar" badge={<span style={{fontSize:9,color:C.green}}>â— TRADINGVIEW LIVE</span>}>
          <TV type="events" height={240} opts={{importanceFilter:"0,1",countryFilter:"us,eu,jp,kr,cn,gb"}}/>
        </Box>

      </div>

        </>)}

      </div>

      {/* í‘¸í„° */}
      <div style={{padding:"6px 16px",borderTop:`1px solid ${C.border}`,display:"flex",justifyContent:"space-between",fontSize:8,color:C.dim}}>
        <span>ì¦ì‹œ/ì„¹í„°/í™˜ìœ¨/ìº˜ë¦°ë”: TradingView (ë¬´ë£Œ ê³µì‹) Â· ì•”í˜¸í™”í: CoinGecko API Â· í™˜ìœ¨: ExchangeRate-API Â· ìê¸ˆíë¦„/ìƒê´€ê´€ê³„/ì•„ë¹„íŠ¸ë¼ì§€: ì¶”ì • ë°ì´í„°</span>
        <span style={{color:C.muted}}>MACRO TERMINAL v5.0 Â· Made for ìµœìœ¤ì¤€</span>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
